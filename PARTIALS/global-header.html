<header class="gh" id="gh-header" role="banner">
<style>
/* ===== ESTILOS (IGUAL QUE ANTES, OPTIMIZADOS) ===== */
:root{--gh-bg:rgba(7,10,16,.95);--gh-border:rgba(255,255,255,.08);--gh-panel:rgba(10,14,23,.98);--gh-text:#e8eef6;--gh-muted:#94a3b8;--gh-brand:#2dd4bf;--gh-brand2:#60a5fa;--gh-maxw:1200px;--gh-height:68px;--gh-offset:68px}
html{scroll-padding-top:calc(var(--gh-offset) + 20px)}
body{padding-top:var(--gh-offset)}
.gh{position:fixed;top:0;left:0;right:0;z-index:9999;font-family:system-ui,-apple-system,sans-serif}
.gh *{box-sizing:border-box}
.gh-bar{height:var(--gh-height);backdrop-filter:blur(12px);-webkit-backdrop-filter:blur(12px);background:var(--gh-bg);border-bottom:1px solid var(--gh-border);transition:transform .3s ease;will-change:transform}
.gh-bar.is-hidden{transform:translateY(-100%)}
.gh-container{max-width:var(--gh-maxw);margin:0 auto;padding:0 clamp(15px,4vw,24px);height:100%;display:flex;align-items:center;justify-content:space-between;gap:20px}
/* LOGO */
.gh-brand{display:flex;align-items:center;gap:12px;text-decoration:none;color:var(--gh-text);padding:4px;border-radius:12px;transition:background .2s}
.gh-brand:hover{background:rgba(255,255,255,.05)}
.gh-brand img{width:42px;height:42px;border-radius:10px;object-fit:cover;background:#1e293b}
.gh-brand-txt{line-height:1.2;display:flex;flex-direction:column}
.gh-brand-txt .n{font-weight:700;font-size:16px;color:#fff;letter-spacing:-0.01em}
.gh-brand-txt .s{font-size:12px;color:var(--gh-muted)}
/* NAV */
.gh-nav{display:none}
@media(min-width:1024px){.gh-nav{display:block}}
.gh-nav ul{display:flex;gap:24px;list-style:none;margin:0;padding:0;align-items:center}
.gh-nav a{color:var(--gh-text);text-decoration:none;font-size:14px;font-weight:500;transition:color .2s;padding:8px 0;position:relative}
.gh-nav a:hover{color:#fff}
.gh-nav a::after{content:'';position:absolute;bottom:0;left:0;width:100%;height:2px;background:var(--gh-brand);transform:scaleX(0);transform-origin:right;transition:transform .3s ease}
.gh-nav a:hover::after{transform:scaleX(1);transform-origin:left}
/* DROPDOWN SIMPLE (Desktop) */
.gh-dd-wrap{position:relative}
.gh-dd-menu{position:absolute;top:100%;left:50%;transform:translate(-50%,15px);background:var(--gh-panel);border:1px solid var(--gh-border);padding:10px;border-radius:12px;min-width:220px;opacity:0;visibility:hidden;transition:.2s ease;box-shadow:0 10px 30px -10px rgba(0,0,0,0.5)}
.gh-dd-wrap:hover .gh-dd-menu,.gh-dd-wrap:focus-within .gh-dd-menu{opacity:1;visibility:visible;transform:translate(-50%,0)}
.gh-dd-menu a{display:flex;align-items:center;gap:10px;padding:10px 12px;border-radius:8px;white-space:nowrap}
.gh-dd-menu a:hover{background:rgba(255,255,255,.05);color:var(--gh-brand)}
/* MEGA MENU (Desktop) */
.gh-mega{width:90vw;max-width:1000px;left:50%;transform:translate(-50%,15px)!important;display:grid;grid-template-columns:repeat(4,1fr);gap:15px;padding:20px}
.gh-col h4{color:var(--gh-muted);font-size:11px;text-transform:uppercase;letter-spacing:1px;margin:0 0 10px;padding-bottom:5px;border-bottom:1px solid var(--gh-border)}
.gh-item{display:flex;align-items:flex-start;gap:10px;padding:8px;border-radius:8px;transition:.2s}
.gh-item:hover{background:rgba(255,255,255,.04)}
.gh-item img{width:32px;height:32px;object-fit:contain}
.gh-item div{display:flex;flex-direction:column}
.gh-item b{font-size:13px;color:#fff}
.gh-item span{font-size:11px;color:var(--gh-muted)}
/* MOBILE TRIGGER */
.gh-actions{display:flex;align-items:center;gap:10px}
.gh-btn-tel{display:none;background:var(--gh-brand);color:#0f172a;padding:6px 14px;border-radius:99px;font-weight:700;font-size:13px;text-decoration:none}
@media(min-width:600px){.gh-btn-tel{display:inline-block}}
.gh-burger{background:transparent;border:1px solid var(--gh-border);color:#fff;font-size:20px;padding:6px 12px;border-radius:8px;cursor:pointer;display:inline-flex;align-items:center;justify-content:center}
@media(min-width:1024px){.gh-burger{display:none}}
/* MOBILE DRAWER */
.gh-overlay{position:fixed;inset:0;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);opacity:0;visibility:hidden;transition:.3s}
.gh-drawer{position:fixed;top:0;right:0;bottom:0;width:min(320px,85vw);background:#0f172a;border-left:1px solid var(--gh-border);transform:translateX(100%);transition:.3s cubic-bezier(0.4,0,0.2,1);display:flex;flex-direction:column;z-index:10000}
html.gh-open .gh-overlay{opacity:1;visibility:visible}
html.gh-open .gh-drawer{transform:translateX(0)}
.gh-d-head{padding:15px;border-bottom:1px solid var(--gh-border);display:flex;justify-content:space-between;align-items:center}
.gh-close{background:transparent;border:0;color:#fff;font-size:24px;cursor:pointer}
.gh-d-body{flex:1;overflow-y:auto;padding:15px}
/* Mobile Accordion */
.gh-acc-btn{width:100%;text-align:left;background:rgba(255,255,255,.03);border:1px solid var(--gh-border);color:#fff;padding:12px;border-radius:8px;margin-bottom:8px;font-weight:600;display:flex;justify-content:space-between}
.gh-acc-content{display:none;padding-left:10px;margin-bottom:15px}
.gh-acc-content.is-open{display:block}
.gh-m-link{display:flex;align-items:center;gap:10px;padding:8px;color:var(--gh-muted);text-decoration:none;border-bottom:1px solid rgba(255,255,255,.05)}
.gh-m-link strong{color:#e8eef6;font-size:14px}
</style>

<div class="gh-bar" id="gh-bar">
  <div class="gh-container">
    <a class="gh-brand js-link" data-href="index.html">
      <img class="js-img" data-src="IMG/expiritilogo.webp" alt="Logo" width="42" height="42">
      <div class="gh-brand-txt"><span class="n">ExpIRI TI</span><span class="s">Expertos CONTPAQi</span></div>
    </a>

    <nav class="gh-nav">
      <ul>
        <li><a class="js-link" data-href="index.html">Inicio</a></li>
        
        <li class="gh-dd-wrap">
          <a class="js-link" data-href="index.html#productos-con">Sistemas ‚ñæ</a>
          <div class="gh-dd-menu mega gh-mega">
            <div class="gh-col">
              <h4>Contables</h4>
              <a class="gh-item js-link" data-href="SISTEMAS/contabilidad.html"><img class="js-img" data-src="IMG/contabilidad.webp" alt=""><div><b>Contabilidad</b><span>P√≥lizas y XML</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/nominas.html"><img class="js-img" data-src="IMG/nominas.webp" alt=""><div><b>N√≥minas</b><span>C√°lculo exacto</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/bancos.html"><img class="js-img" data-src="IMG/bancos.webp" alt=""><div><b>Bancos</b><span>Tesorer√≠a</span></div></a>
            </div>
            <div class="gh-col">
              <h4>Comerciales</h4>
              <a class="gh-item js-link" data-href="SISTEMAS/comercialpremium.html"><img class="js-img" data-src="IMG/comercialpremium.webp" alt=""><div><b>Premium</b><span>Gesti√≥n total</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/comercialpro.html"><img class="js-img" data-src="IMG/comercialpro.webp" alt=""><div><b>Pro</b><span>Multisucursal</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/facturaelectronica.html"><img class="js-img" data-src="IMG/factura.webp" alt=""><div><b>Factura</b><span>Timbrado ilimitado</span></div></a>
            </div>
            <div class="gh-col">
              <h4>Nube</h4>
              <a class="gh-item js-link" data-href="SISTEMAS/contabiliza.html"><img class="js-img" data-src="IMG/contabiliza.webp" alt=""><div><b>Contabiliza</b><span>Contador m√≥vil</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/vende.html"><img class="js-img" data-src="IMG/vende.webp" alt=""><div><b>Vende</b><span>Factura web</span></div></a>
              <a class="gh-item js-link" data-href="SISTEMAS/personia.html"><img class="js-img" data-src="IMG/personia.webp" alt=""><div><b>Personia</b><span>N√≥mina nube</span></div></a>
            </div>
            <div class="gh-col">
              <h4>Servicios</h4>
              <a class="gh-item js-link" data-href="index.html#promociones"><img class="js-img" data-src="IMG/etiqueta-de-precio.webp" alt=""><div><b>Promociones</b><span>Descuentos</span></div></a>
            </div>
          </div>
        </li>

        <li class="gh-dd-wrap">
          <a class="js-link" data-href="index.html#servicios">Servicios ‚ñæ</a>
          <div class="gh-dd-menu">
            <a class="js-link" data-href="SERVICIOS/polizas.html">üõ°Ô∏è P√≥lizas de Soporte</a>
            <a class="js-link" data-href="SERVICIOS/implementaciones.html">‚öôÔ∏è Implementaciones</a>
            <a class="js-link" data-href="SERVICIOS/migraciones.html">üîÑ Migraciones</a>
            <a class="js-link" data-href="SERVICIOS/cursos.html">üéì Cursos</a>
            <a class="js-link" data-href="SERVICIOS/servidoresvirtuales.html">‚òÅÔ∏è Servidores Virtuales</a>
          </div>
        </li>

        <li><a class="js-link" data-href="index.html#contacto">Contacto</a></li>
      </ul>
    </nav>

    <div class="gh-actions">
      <a class="gh-btn-tel" href="tel:+525568437918">55 6843 7918</a>
      <button class="gh-burger" id="gh-burger-btn" aria-label="Menu">‚ò∞</button>
    </div>
  </div>
</div>

<div class="gh-overlay" id="gh-overlay"></div>
<aside class="gh-drawer" id="gh-drawer">
  <div class="gh-d-head">
    <span style="color:#fff;font-weight:bold">Men√∫</span>
    <button class="gh-close" id="gh-close-btn">‚úï</button>
  </div>
  <div class="gh-d-body">
    <a class="gh-acc-btn js-link" data-href="index.html">Inicio</a>
    
    <button class="gh-acc-btn" onclick="this.nextElementSibling.classList.toggle('is-open')">Sistemas ‚ñæ</button>
    <div class="gh-acc-content">
      <a class="gh-m-link js-link" data-href="SISTEMAS/contabilidad.html"><strong>Contabilidad</strong></a>
      <a class="gh-m-link js-link" data-href="SISTEMAS/nominas.html"><strong>N√≥minas</strong></a>
      <a class="gh-m-link js-link" data-href="SISTEMAS/bancos.html"><strong>Bancos</strong></a>
      <a class="gh-m-link js-link" data-href="SISTEMAS/comercialpremium.html"><strong>Comercial Premium</strong></a>
      <a class="gh-m-link js-link" data-href="SISTEMAS/contabiliza.html"><strong>Contabiliza (Nube)</strong></a>
    </div>

    <button class="gh-acc-btn" onclick="this.nextElementSibling.classList.toggle('is-open')">Servicios ‚ñæ</button>
    <div class="gh-acc-content">
      <a class="gh-m-link js-link" data-href="SERVICIOS/polizas.html">P√≥lizas</a>
      <a class="gh-m-link js-link" data-href="SERVICIOS/soporte.html">Soporte</a>
    </div>

    <a class="gh-acc-btn js-link" data-href="index.html#contacto">Contacto</a>
    <br>
    <a class="gh-acc-btn" href="tel:+525568437918" style="background:var(--gh-brand);color:#000;justify-content:center">Llamar Ahora</a>
  </div>
</aside>
</header>

<script>
/* =========================================================
   JS INFALIBLE V7.0
   L√≥gica: Detecta la RA√çZ REAL del dominio y construye URLs absolutas.
   0% Adivinanzas. 100% Matem√°ticas.
========================================================= */
(function() {
  "use strict";
  if (window.__GH_V7_LOADED__) return;
  window.__GH_V7_LOADED__ = true;

  // 1. OBTENER LA RA√çZ MAESTRA (La fuente de la verdad)
  function getMasterRoot() {
    // A. ¬øHay meta tag definido por el usuario? (Lo m√°s seguro)
    const meta = document.querySelector('meta[name="expiriti-base"]');
    if (meta && meta.content) {
      let r = meta.content.trim();
      // Asegurar formato "/algo/"
      if (!r.startsWith("/")) r = "/" + r;
      if (!r.endsWith("/")) r = r + "/";
      return r;
    }

    // B. Detecci√≥n autom√°tica robusta
    const path = window.location.pathname;
    // Si estamos en GitHub Pages, la ra√≠z suele ser /nombre-repo/
    // Detectamos si el primer segmento no es un archivo
    const parts = path.split('/').filter(Boolean);
    if (window.location.hostname.includes('github.io') && parts.length > 0) {
      return "/" + parts[0] + "/";
    }
    
    // C. Por defecto (dominio propio o localhost ra√≠z)
    return "/";
  }

  const ROOT = getMasterRoot();
  console.log("Expiriti Header: Root detectada como ->", ROOT);

  // 2. FUNCI√ìN CONSTRUCTORA DE URLS (Indestructible)
  function buildPath(raw) {
    if (!raw) return "#";
    // Si ya es externa, no tocar
    if (/^(http|https|mailto|tel|whatsapp):/.test(raw)) return raw;
    // Si es ancla simple (#contacto), agregar ruta completa al index
    if (raw.startsWith("#")) {
      return window.location.origin + ROOT + "index.html" + raw;
    }
    // Construir ruta absoluta: Origen + Ra√≠z + Recurso
    // Elimina barras iniciales para evitar // dobles
    const cleanRaw = raw.replace(/^\//, "");
    return window.location.origin + ROOT + cleanRaw;
  }

  // 3. APLICAR A TODO EL HEADER
  function applySafePaths(container = document) {
    // Links
    const links = container.querySelectorAll('.js-link');
    links.forEach(a => {
      const raw = a.getAttribute('data-href');
      if(raw) a.href = buildPath(raw);
    });

    // Im√°genes
    const imgs = container.querySelectorAll('.js-img');
    imgs.forEach(img => {
      const raw = img.getAttribute('data-src');
      if (raw) {
        img.src = buildPath(raw);
        // Fallback silencioso si falla la imagen
        img.onerror = function() {
          this.style.opacity = "0.5";
          // Placeholder transparente de 1px
          this.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3C/svg%3E";
        };
      }
    });
  }

  // 4. L√ìGICA DE MEN√ö M√ìVIL (Simple y s√≥lida)
  function initDrawer() {
    const btn = document.getElementById('gh-burger-btn');
    const close = document.getElementById('gh-close-btn');
    const overlay = document.getElementById('gh-overlay');
    const html = document.documentElement;

    function toggle(open) {
      if(open) html.classList.add('gh-open');
      else html.classList.remove('gh-open');
    }

    if(btn) btn.onclick = () => toggle(true);
    if(close) close.onclick = () => toggle(false);
    if(overlay) overlay.onclick = () => toggle(false);
    
    // Cerrar al hacer click en links internos
    document.querySelectorAll('.gh-drawer a').forEach(a => {
      a.addEventListener('click', () => toggle(false));
    });
  }

  // 5. AUTOCORRECCI√ìN DE SCROLL (Barra se esconde suave)
  function initScroll() {
    let lastY = window.scrollY;
    const bar = document.getElementById('gh-bar');
    if(!bar) return;
    
    window.addEventListener('scroll', () => {
      const y = window.scrollY;
      if (y > 60 && y > lastY) bar.classList.add('is-hidden');
      else bar.classList.remove('is-hidden');
      lastY = y;
    }, {passive: true});
  }

  // 6. INICIALIZADOR MAESTRO (Ejecuta ahora y vigila cambios)
  function boot() {
    const h = document.getElementById('gh-header');
    if (h) {
      applySafePaths(h);
      initDrawer();
      initScroll();
      // Ajuste de espacio superior para no tapar contenido
      const hHeight = document.getElementById('gh-bar')?.offsetHeight || 68;
      document.documentElement.style.setProperty('--gh-offset', hHeight + 'px');
    }
  }

  // Ejecuci√≥n Inmediata
  boot();
  
  // Ejecuci√≥n Diferida (por si el script carga antes que el HTML)
  document.addEventListener('DOMContentLoaded', boot);
  
  // Ejecuci√≥n Blindada (MutationObserver): Si algo inyecta el header tarde, esto lo atrapa
  const observer = new MutationObserver(() => {
    if(document.getElementById('gh-header') && !document.querySelector('.gh-open')) {
      // Solo reaplicar rutas si detectamos elementos sin procesar
      if(document.querySelector('.js-link[data-href]:not([href])')) {
        boot();
      }
    }
  });
  observer.observe(document.body, {childList: true, subtree: true});

})();
</script>

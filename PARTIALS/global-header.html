<!-- /PARTIALS/global-header.html -->
<header class="gh" role="banner">
  <style>
    /* ====== GLOBAL HEADER (scoped) ====== */
    .gh{position:sticky;top:0;z-index:999;background:var(--bg,#0b0f14);border-bottom:1px solid rgba(255,255,255,.06)}
    .gh-container{max-width:var(--maxw,1200px);margin:0 auto;padding:10px 16px;display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center}
    .gh-brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text,#e8eef6)}
    .gh-brand img{width:34px;height:34px;border-radius:8px}
    .gh-brand-title{line-height:1}
    .gh-brand-title small{display:block;font-size:12px;color:var(--muted,#95a2b3)}

    /* Nav */
    .gh-nav{justify-self:center}
    .gh-nav > ul{display:flex;gap:14px;list-style:none;margin:0;padding:0;align-items:center}
    .gh-nav a{color:var(--text,#e8eef6);text-decoration:none;font-weight:500;padding:8px 10px;border-radius:10px}
    .gh-nav a:hover{background:rgba(255,255,255,.06)}
    .gh-has-dd{position:relative}
    .gh-dd{position:absolute;left:0;top:calc(100% + 8px);background:var(--bg-2,#0d1219);border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow,0 10px 30px rgba(0,0,0,.25));border-radius:14px;min-width:280px;padding:10px;display:none}
    .gh-has-dd:focus-within .gh-dd,.gh-has-dd:hover .gh-dd{display:block}

    /* ====== Mega menú Productos (4 columnas) ====== */
    .gh-dd.mega{min-width:1000px;padding:14px}
    .gh-mega{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
    .gh-col{background:var(--card,#111723);border:1px solid rgba(255,255,255,.06);border-radius:14px;padding:12px}
    .gh-col h4{margin:0 0 8px;font-size:13px;letter-spacing:.02em;color:var(--text);text-transform:uppercase}
    .gh-subhead{display:flex;align-items:center;gap:6px;margin:10px 0 6px;font-weight:600;font-size:12px;color:var(--muted)}
    .gh-subhead svg{width:16px;height:16px;opacity:.9}
    .gh-col ul{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:6px}
    .gh-col a.gh-link{
      display:flex;gap:10px;align-items:center;
      padding:8px 10px;border-radius:10px;text-decoration:none;color:var(--text);
      border:1px solid transparent
    }
    .gh-col a.gh-link:hover{background:rgba(255,255,255,.06);border-color:rgba(255,255,255,.10);transform:translateY(-1px)}
    .gh-col .k{font-size:11px;color:var(--muted)}
    .gh-ico32{width:28px;height:28px;border-radius:6px;object-fit:cover;flex:0 0 28px}
    .gh-link .txt{display:flex;flex-direction:column;line-height:1.15}
    .gh-link .sub{font-size:11px;color:var(--muted);margin-top:2px}

    /* Servicios list */
    .gh-list{display:flex;flex-direction:column;gap:6px;min-width:280px}
    .gh-list a{display:flex;gap:10px;align-items:center;padding:10px;border-radius:10px;color:var(--text);text-decoration:none;background:var(--card,#111723);border:1px solid rgba(255,255,255,.06)}
    .gh-list a:hover{border-color:rgba(255,255,255,.14)}
    .gh-ico{width:18px;height:18px;opacity:.9}

    /* CTAs */
    .gh-cta{display:flex;gap:8px;align-items:center}
    .gh-btn{border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:8px 12px;border-radius:12px;text-decoration:none}
    .gh-btn:hover{background:rgba(255,255,255,.06)}
    .gh-burger{display:none;border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:8px 10px;border-radius:10px;font-size:18px}

    /* Subnav contextual */
    .gh-subnav{display:none;border-top:1px solid rgba(255,255,255,.06);background:var(--bg,#0b0f14)}
    .gh-subinner{max-width:var(--maxw,1200px);margin:0 auto;padding:8px 16px;display:flex;gap:8px;flex-wrap:wrap}
    .gh-subinner a{font-size:13px;border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;text-decoration:none;color:var(--text)}
    .gh-subinner a:hover{background:rgba(255,255,255,.06)}

    /* Mobile */
    @media (max-width: 980px){
      .gh-nav{display:none}
      .gh-burger{display:inline-block}
      .gh-cta .gh-btn:first-child{display:none}
      .gh-mobile{position:fixed;inset:0 0 0 auto;width:min(86%,360px);background:var(--bg-2,#0d1219);transform:translateX(100%);transition:.24s ease;box-shadow:var(--shadow);display:flex;flex-direction:column}
      .gh-mobile.open{transform:translateX(0)}
      .gh-mhead{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid rgba(255,255,255,.08)}
      .gh-mbody{padding:10px 14px;overflow:auto}
      .gh-mnav{display:flex;flex-direction:column;gap:6px}
      .gh-mnav details{border:1px solid rgba(255,255,255,.08);border-radius:12px;overflow:hidden;background:var(--card,#111723)}
      .gh-mnav summary{padding:12px 12px;cursor:pointer;font-weight:600;list-style:none}
      .gh-mnav a{display:block;padding:10px 12px;color:var(--text);text-decoration:none;border-top:1px solid rgba(255,255,255,.06)}
      .gh-mclose{border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:6px 10px;border-radius:10px}
      /* Mega a una columna en móvil */
      .gh-dd.mega{min-width:unset;padding:10px}
      .gh-mega{grid-template-columns:1fr;gap:10px}
    }
  </style>

  <!-- Top row -->
  <div class="gh-container">
    <a class="gh-brand js-abs-href" data-href="index.html" aria-label="Inicio Expiriti">
      <img class="js-abs-src" data-src="IMG/expiritilogo.webp" alt="Expiriti">
      <div class="gh-brand-title">Distribuidor<small>Certificado CONTPAQi</small></div>
    </a>

    <nav class="gh-nav" aria-label="Principal">
      <ul>
        <li><a class="js-abs-href" data-href="index.html">Inicio</a></li>

        <!-- Productos -->
        <li class="gh-has-dd">
          <a class="js-abs-href" data-href="index.html#productos" aria-haspopup="true" aria-expanded="false">Productos</a>
          <div class="gh-dd mega" role="menu">
            <div class="gh-mega">
              <!-- Columna 1: PROCESOS CONTABLES -->
              <div class="gh-col">
                <h4>Procesos contables</h4>

                <div class="gh-subhead">
                  <svg viewBox="0 0 24 24" fill="none"><rect x="3" y="5" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 19h6" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Desktop</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/contabilidad.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/contabilidad.webp" alt="">
                      <span class="txt"><strong>CONTPAQi Contabilidad®</strong><span class="sub">Pólizas, IVA, DIOT</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/nominas.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/nominas.webp" alt="">
                      <span class="txt"><strong>CONTPAQi Nóminas®</strong><span class="sub">Cálculo y timbrado</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/bancos.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/bancos.webp" alt="">
                      <span class="txt"><strong>CONTPAQi Bancos®</strong><span class="sub">Conciliación y tesorería</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/xmlenlinea.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/xmllinea.webp" alt="">
                      <span class="txt"><strong>XML en Línea+®</strong><span class="sub">Descarga/validación CFDI</span></span>
                    </a>
                  </li>
                </ul>

                <div class="gh-subhead" style="margin-top:10px">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M7 14a5 5 0 0 1 9.7-1.5A4 4 0 1 1 17 19H8a4 4 0 0 1-1-7.85" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Nube</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/contabiliza.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/contabiliza.webp" alt="">
                      <span class="txt"><strong>Contabiliza®</strong><span class="sub">Contabilidad en la nube</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/analiza.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/analiza.webp" alt="">
                      <span class="txt"><strong>Analiza®</strong><span class="sub">Dashboards y BI</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/personia.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/personia.webp" alt="">
                      <span class="txt"><strong>Personia®</strong><span class="sub">Nómina en la nube</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/despachos.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/despachos.webp" alt="">
                      <span class="txt"><strong>Despachos®</strong><span class="sub">Gestión de despachos</span></span>
                    </a>
                  </li>
                </ul>
              </div>

              <!-- Columna 2: PROCESOS COMERCIALES -->
              <div class="gh-col">
                <h4>Procesos comerciales</h4>

                <div class="gh-subhead">
                  <svg viewBox="0 0 24 24" fill="none"><rect x="3" y="5" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 19h6" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Desktop</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/comercialpremium.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/comercialpremium.webp" alt="">
                      <span class="txt"><strong>Comercial Premium®</strong><span class="sub">Inventario avanzado</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/comercialpro.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/comercialpro.webp" alt="">
                      <span class="txt"><strong>Comercial Pro®</strong><span class="sub">Operaciones de volumen</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/comercialstart.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/comercialstart.webp" alt="">
                      <span class="txt"><strong>Comercial Start®</strong><span class="sub">Lo esencial para arrancar</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/facturaelectronica.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/facturaelectronica.webp" alt="">
                      <span class="txt"><strong>Factura Electrónica®</strong><span class="sub">CFDI 4.0</span></span>
                    </a>
                  </li>
                </ul>

                <div class="gh-subhead" style="margin-top:10px">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M7 14a5 5 0 0 1 9.7-1.5A4 4 0 1 1 17 19H8a4 4 0 0 1-1-7.85" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Nube</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/vende.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/vende.webp" alt="">
                      <span class="txt"><strong>Vende®</strong><span class="sub">Punto de venta nube</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/facturaelectronica.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/facturaelectronica.webp" alt="">
                      <span class="txt"><strong>CFDI en Línea®</strong><span class="sub">Facturación/Timbre</span></span>
                    </a>
                  </li>
                </ul>
              </div>

              <!-- Columna 3: PRODUCTIVIDAD -->
              <div class="gh-col">
                <h4>Productividad</h4>

                <div class="gh-subhead">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M7 14a5 5 0 0 1 9.7-1.5A4 4 0 1 1 17 19H8a4 4 0 0 1-1-7.85" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Nube</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/kursa.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/kursa.webp" alt="">
                      <span class="txt"><strong>Kursa®</strong><span class="sub">Capacitación</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/evalua.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/evalua.webp" alt="">
                      <span class="txt"><strong>Evalúa®</strong><span class="sub">NOM 035/037</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/colabora.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/colabora.webp" alt="">
                      <span class="txt"><strong>Colabora®</strong><span class="sub">Autoservicio empleados</span></span>
                    </a>
                  </li>
                </ul>

                <div class="gh-subhead" style="margin-top:10px">
                  <svg viewBox="0 0 24 24" fill="none"><rect x="3" y="5" width="18" height="12" rx="2" stroke="currentColor" stroke-width="2"/><path d="M9 19h6" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Promociones del mes</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="promociones.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/promo.webp" alt="">
                      <span class="txt"><strong>Ver promociones</strong><span class="sub">Descuentos vigentes</span></span>
                    </a>
                  </li>
                </ul>
              </div>

              <!-- Columna 4: INFRAESTRUCTURA Y SERVICIOS NUBE -->
              <div class="gh-col">
                <h4>Infraestructura y servicios nube</h4>

                <div class="gh-subhead">
                  <svg viewBox="0 0 24 24" fill="none"><path d="M7 14a5 5 0 0 1 9.7-1.5A4 4 0 1 1 17 19H8a4 4 0 0 1-1-7.85" stroke="currentColor" stroke-width="2"/></svg>
                  <span class="k">Nube</span>
                </div>
                <ul>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/respaldo.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/respaldos.webp" alt="">
                      <span class="txt"><strong>Respaldos®</strong><span class="sub">Backups administrados</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/escritorio-virtual.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/escritorio-virtual.webp" alt="">
                      <span class="txt"><strong>Escritorio Virtual®</strong><span class="sub">Apps en la nube</span></span>
                    </a>
                  </li>
                  <li>
                    <a class="gh-link js-abs-href" data-href="SISTEMAS/timbra.html">
                      <img class="gh-ico32 js-abs-src" data-src="IMG/timbra.webp" alt="">
                      <span class="txt"><strong>Timbra®</strong><span class="sub">Servicio de timbrado</span></span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </li>

        <!-- Servicios -->
        <li class="gh-has-dd">
          <a class="js-abs-href" data-href="servicios.html" aria-haspopup="true" aria-expanded="false">Servicios</a>
          <div class="gh-dd" role="menu">
            <div class="gh-list" role="group" aria-label="Servicios">
              <a class="js-abs-href" data-href="SERVICIOS/implementacion.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M12 3v18M3 12h18" stroke="currentColor" stroke-width="2"/></svg> Implementación</a>
              <a class="js-abs-href" data-href="SERVICIOS/capacitacion.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M4 19h16M8 5h8v10H8z" stroke="currentColor" stroke-width="2"/></svg> Capacitación</a>
              <a class="js-abs-href" data-href="SERVICIOS/soporte.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M12 6a6 6 0 0 0-6 6v4h12v-4a6 6 0 0 0-6-6z" stroke="currentColor" stroke-width="2"/></svg> Soporte</a>
              <a class="js-abs-href" data-href="SERVICIOS/desarrollos.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M8 8l-4 4 4 4M16 8l4 4-4 4" stroke="currentColor" stroke-width="2"/></svg> Desarrollos a la medida</a>
              <a class="js-abs-href" data-href="SERVICIOS/integraciones.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M7 7h10v10H7z" stroke="currentColor" stroke-width="2"/></svg> Integraciones / SDK</a>
              <a class="js-abs-href" data-href="SERVICIOS/migraciones.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M4 12h16M12 4l8 8-8 8" stroke="currentColor" stroke-width="2"/></svg> Migraciones</a>
            </div>
          </div>
        </li>

        <li><a class="js-abs-href" data-href="promociones.html">Promociones</a></li>
        <li><a class="js-abs-href" data-href="eventos.html">Eventos</a></li>
        <li><a class="js-abs-href" data-href="nosotros.html">Nosotros</a></li>
        <li><a class="js-abs-href" data-href="contacto.html">Contacto</a></li>
      </ul>
    </nav>

    <div class="gh-cta">
      <a class="gh-btn" href="tel:+525568437918">55 6843 7918</a>
      <a class="gh-btn" href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20informaci%C3%B3n" target="_blank" rel="noopener">WhatsApp</a>
      <button class="gh-burger" id="gh-burger" aria-label="Abrir menú">≡</button>
    </div>
  </div>

  <!-- Subnav contextual -->
  <div class="gh-subnav" id="gh-subnav" aria-label="Accesos rápidos">
    <div class="gh-subinner" id="gh-subinner"></div>
  </div>


  <script>
    (() => {
      const $ = (s,ctx=document)=>ctx.querySelector(s);
      const $$ = (s,ctx=document)=>Array.from(ctx.querySelectorAll(s));

      /* ===== Resolver rutas (repoBase-aware) ===== */
      const isGh = location.hostname.endsWith("github.io");
      const firstSeg = location.pathname.split("/")[1] || "";
      const repoBase = (isGh && firstSeg) ? ("/"+firstSeg) : "";
      const makeAbs = (p) => {
        if (!p) return "#";
        if (/^https?:\/\//i.test(p)) return p;          // externo
        if (p.startsWith("#")) return p;                // ancla
        if (p.startsWith("/")) return (repoBase + p).replace(/\/+/g,"/");
        return (repoBase + "/" + p).replace(/\/+/g,"/"); // relativo al repo
      };

      // <a class="js-abs-href" data-href="...">
      $$('.js-abs-href[data-href]').forEach(a=>{
        const p = a.getAttribute('data-href');
        const [base, hash] = (p||"").split('#');
        a.href = makeAbs(base) + (hash ? ('#'+hash) : '');
      });

      // <img class="js-abs-src" data-src="...">
      $$('.js-abs-src[data-src]').forEach(img=>{
        img.src = makeAbs(img.getAttribute('data-src'));
      });

      /* Burger */
      const burger = $('#gh-burger');
      const drawer = $('#gh-mobile');
      const closeBtn = $('#gh-mclose');
      const toggle = (open)=> {
        drawer.classList.toggle('open', open);
        drawer.setAttribute('aria-hidden', (!open).toString());
        document.body.style.overflow = open ? 'hidden' : '';
      };
      burger?.addEventListener('click', ()=>toggle(true));
      closeBtn?.addEventListener('click', ()=>toggle(false));
      drawer?.addEventListener('click', (e)=>{ if(e.target===drawer) toggle(false); });

      /* Activo por ruta (comparando pathname normalizado) */
      const norm = (u) => {
        try{
          const url = new URL(u, location.origin);
          return url.pathname.replace(/\/index\.html?$/,'/').replace(/\/+/g,'/');
        }catch{ return u; }
      };
      const here = norm(location.pathname);
      $$('.gh-nav a, .gh-mnav a').forEach(a=>{
        const href = a.getAttribute('href');
        if(!href || href.startsWith('http')) return;
        if (norm(href) === here) a.style.background = 'rgba(255,255,255,.08)';
      });

      /* Subnav contextual (si existen anclas en la página actual) */
      const sub = $('#gh-subnav'); const inner = $('#gh-subinner');
      const anchors = [
        ['#caracteristicas','Funcionalidades'],
        ['#videos','Vídeos'],
        ['#integra','Integraciones'],
        ['#calculadora-section','Precio'],
        ['#comparativa','Comparativa'],
        ['#faq','Preguntas frecuentes'],
        ['#sesion-guiada','Demo']
      ].filter(([id])=>document.querySelector(id));
      if(anchors.length){
        sub.style.display='block';
        inner.innerHTML = anchors.map(([id,txt])=>`<a href="${id}">${txt}</a>`).join('');
      }

      /* Accesibilidad: ArrowDown para entrar al dropdown */
      $$('.gh-has-dd > a').forEach(trigger=>{
        const dd = trigger.parentElement.querySelector('.gh-dd');
        trigger.addEventListener('keydown', (e)=>{
          if(e.key==='ArrowDown'){ e.preventDefault(); dd?.querySelector('a,button,summary')?.focus(); }
        });
      });
    })();
  </script>
</header>

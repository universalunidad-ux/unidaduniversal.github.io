<!-- /PARTIALS/global-header.html -->
<header class="gh" role="banner">
  <style>
    /* ====== GLOBAL HEADER (scoped) ====== */
    .gh{position:sticky;top:0;z-index:999;background:var(--bg,#0b0f14);border-bottom:1px solid rgba(255,255,255,.06)}
    .gh-container{max-width:var(--maxw,1200px);margin:0 auto;padding:10px 16px;display:grid;grid-template-columns:auto 1fr auto;gap:12px;align-items:center}
    .gh-brand{display:flex;align-items:center;gap:10px;text-decoration:none;color:var(--text,#e8eef6)}
    .gh-brand img{width:34px;height:34px;border-radius:8px}
    .gh-brand-title{line-height:1}
    .gh-brand-title small{display:block;font-size:12px;color:var(--muted,#95a2b3)}
    /* Nav */
    .gh-nav{justify-self:center}
    .gh-nav > ul{display:flex;gap:14px;list-style:none;margin:0;padding:0;align-items:center}
    .gh-nav a{color:var(--text,#e8eef6);text-decoration:none;font-weight:500;padding:8px 10px;border-radius:10px}
    .gh-nav a:hover{background:rgba(255,255,255,.06)}
    .gh-has-dd{position:relative}
    .gh-dd{position:absolute;left:0;top:calc(100% + 8px);background:var(--bg-2,#0d1219);border:1px solid rgba(255,255,255,.08);box-shadow:var(--shadow,0 10px 30px rgba(0,0,0,.25));border-radius:14px;min-width:280px;padding:10px;display:none}
    .gh-has-dd:focus-within .gh-dd,.gh-has-dd:hover .gh-dd{display:block}
    /* Productos mega-grid */
    .gh-dd.grid{min-width:640px}
    .gh-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px}
    .gh-item{display:flex;gap:10px;align-items:center;padding:10px;border-radius:12px;color:var(--text);text-decoration:none;border:1px solid rgba(255,255,255,.06);background:var(--card,#111723)}
    .gh-item:hover{border-color:rgba(255,255,255,.14);transform:translateY(-1px)}
    .gh-item img{width:28px;height:28px;border-radius:6px;object-fit:cover}
    .gh-item h5{margin:0;font-size:14px}
    .gh-item p{margin:2px 0 0;color:var(--muted);font-size:12px}
    /* Servicios list */
    .gh-list{display:flex;flex-direction:column;gap:6px;min-width:280px}
    .gh-list a{display:flex;gap:10px;align-items:center;padding:10px;border-radius:10px;color:var(--text);text-decoration:none;background:var(--card,#111723);border:1px solid rgba(255,255,255,.06)}
    .gh-list a:hover{border-color:rgba(255,255,255,.14)}
    .gh-ico{width:18px;height:18px;opacity:.9}
    /* CTAs */
    .gh-cta{display:flex;gap:8px;align-items:center}
    .gh-btn{border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:8px 12px;border-radius:12px;text-decoration:none}
    .gh-btn:hover{background:rgba(255,255,255,.06)}
    .gh-burger{display:none;border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:8px 10px;border-radius:10px;font-size:18px}
    /* Subnav contextual */
    .gh-subnav{display:none;border-top:1px solid rgba(255,255,255,.06);background:var(--bg,#0b0f14)}
    .gh-subinner{max-width:var(--maxw,1200px);margin:0 auto;padding:8px 16px;display:flex;gap:8px;flex-wrap:wrap}
    .gh-subinner a{font-size:13px;border:1px solid rgba(255,255,255,.12);padding:6px 10px;border-radius:999px;text-decoration:none;color:var(--text)}
    .gh-subinner a:hover{background:rgba(255,255,255,.06)}
    /* Mobile */
    @media (max-width: 980px){
      .gh-nav{display:none}
      .gh-burger{display:inline-block}
      .gh-cta .gh-btn:first-child{display:none}
      .gh-mobile{position:fixed;inset:0 0 0 auto;width:min(86%,360px);background:var(--bg-2,#0d1219);transform:translateX(100%);transition:.24s ease;box-shadow:var(--shadow);display:flex;flex-direction:column}
      .gh-mobile.open{transform:translateX(0)}
      .gh-mhead{display:flex;align-items:center;justify-content:space-between;padding:14px;border-bottom:1px solid rgba(255,255,255,.08)}
      .gh-mbody{padding:10px 14px;overflow:auto}
      .gh-mnav{display:flex;flex-direction:column;gap:6px}
      .gh-mnav details{border:1px solid rgba(255,255,255,.08);border-radius:12px;overflow:hidden;background:var(--card,#111723)}
      .gh-mnav summary{padding:12px 12px;cursor:pointer;font-weight:600;list-style:none}
      .gh-mnav a{display:block;padding:10px 12px;color:var(--text);text-decoration:none;border-top:1px solid rgba(255,255,255,.06)}
      .gh-mclose{border:1px solid rgba(255,255,255,.16);background:transparent;color:var(--text);padding:6px 10px;border-radius:10px}
    }
  </style>

  <!-- Top row -->
  <div class="gh-container">
    <a class="gh-brand js-abs-href" data-href="index.html" aria-label="Inicio Expiriti">
      <img class="js-abs-src" data-src="IMG/expiritilogo.webp" alt="Expiriti">
      <div class="gh-brand-title">Expiriti<small>Distribuidor CONTPAQi</small></div>
    </a>

    <nav class="gh-nav" aria-label="Principal">
      <ul>
        <li><a class="js-abs-href" data-href="index.html">Inicio</a></li>

        <!-- Productos -->
        <li class="gh-has-dd">
          <a class="js-abs-href" data-href="index.html#productos" aria-haspopup="true" aria-expanded="false">Productos</a>
          <div class="gh-dd grid" role="menu">
            <div class="gh-grid">
              <a class="gh-item js-abs-href" data-href="SISTEMAS/contabilidad.html">
                <img class="js-abs-src" data-src="IMG/contabilidad.webp" alt="">
                <div><h5>Contabilidad</h5><p>P√≥lizas, IVA, DIOT, reportes</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/bancos.html">
                <img class="js-abs-src" data-src="IMG/bancos.webp" alt="">
                <div><h5>Bancos</h5><p>Conciliaci√≥n y tesorer√≠a</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/comercialpremium.html">
                <img class="js-abs-src" data-src="IMG/comercialpremium.webp" alt="">
                <div><h5>Comercial Premium</h5><p>Inventario, producci√≥n, servicios</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/comercialpro.html">
                <img class="js-abs-src" data-src="IMG/comercialpro.webp" alt="">
                <div><h5>Comercial Pro</h5><p>Compras, ventas, trazabilidad</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/vende.html">
                <img class="js-abs-src" data-src="IMG/vende.webp" alt="">
                <div><h5>Vende</h5><p>CFDI ilimitados en la nube</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/personia.html">
                <img class="js-abs-src" data-src="IMG/personia.webp" alt="">
                <div><h5>Personia</h5><p>N√≥mina en la nube</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/analiza.html">
                <img class="js-abs-src" data-src="IMG/analiza.webp" alt="">
                <div><h5>Analiza</h5><p>Dashboards y BI</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/xmlenlinea.html">
                <img class="js-abs-src" data-src="IMG/xmllinea.webp" alt="">
                <div><h5>XML en L√≠nea</h5><p>Descarga y validaci√≥n CFDI</p></div>
              </a>
              <a class="gh-item js-abs-href" data-href="SISTEMAS/colabora.html">
                <img class="js-abs-src" data-src="IMG/colabora.webp" alt="">
                <div><h5>Colabora</h5><p>Autoservicio de empleados</p></div>
              </a>
            </div>
          </div>
        </li>

        <!-- Servicios -->
        <li class="gh-has-dd">
          <a class="js-abs-href" data-href="servicios.html" aria-haspopup="true" aria-expanded="false">Servicios</a>
          <div class="gh-dd" role="menu">
            <div class="gh-list" role="group" aria-label="Servicios">
              <a class="js-abs-href" data-href="SERVICIOS/implementacion.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M12 3v18M3 12h18" stroke="currentColor" stroke-width="2"/></svg> Implementaci√≥n</a>
              <a class="js-abs-href" data-href="SERVICIOS/capacitacion.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M4 19h16M8 5h8v10H8z" stroke="currentColor" stroke-width="2"/></svg> Capacitaci√≥n</a>
              <a class="js-abs-href" data-href="SERVICIOS/soporte.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M12 6a6 6 0 0 0-6 6v4h12v-4a6 6 0 0 0-6-6z" stroke="currentColor" stroke-width="2"/></svg> Soporte</a>
              <a class="js-abs-href" data-href="SERVICIOS/desarrollos.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M8 8l-4 4 4 4M16 8l4 4-4 4" stroke="currentColor" stroke-width="2"/></svg> Desarrollos a la medida</a>
              <a class="js-abs-href" data-href="SERVICIOS/integraciones.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M7 7h10v10H7z" stroke="currentColor" stroke-width="2"/></svg> Integraciones / SDK</a>
              <a class="js-abs-href" data-href="SERVICIOS/migraciones.html"><svg class="gh-ico" viewBox="0 0 24 24" fill="none"><path d="M4 12h16M12 4l8 8-8 8" stroke="currentColor" stroke-width="2"/></svg> Migraciones</a>
            </div>
          </div>
        </li>

        <li><a class="js-abs-href" data-href="promociones.html">Promociones</a></li>
        <li><a class="js-abs-href" data-href="eventos-del-mes.html">Eventos del mes</a></li>
        <li><a class="js-abs-href" data-href="nosotros.html">Nosotros</a></li>
        <li><a class="js-abs-href" data-href="contacto.html">Contacto</a></li>
      </ul>
    </nav>

    <div class="gh-cta">
      <a class="gh-btn" href="tel:+525568437918">55 6843 7918</a>
      <a class="gh-btn" href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20informaci%C3%B3n" target="_blank" rel="noopener">WhatsApp</a>
      <button class="gh-burger" id="gh-burger" aria-label="Abrir men√∫">‚â°</button>
    </div>
  </div>

  <!-- Subnav contextual -->
  <div class="gh-subnav" id="gh-subnav" aria-label="Accesos r√°pidos">
    <div class="gh-subinner" id="gh-subinner"></div>
  </div>

  <!-- Mobile drawer -->
  <aside class="gh-mobile" id="gh-mobile" aria-hidden="true">
    <div class="gh-mhead">
      <strong>Men√∫</strong>
      <button class="gh-mclose" id="gh-mclose" aria-label="Cerrar">Cerrar</button>
    </div>
    <div class="gh-mbody">
      <nav class="gh-mnav" aria-label="Navegaci√≥n m√≥vil">
        <a class="js-abs-href" data-href="index.html">Inicio</a>

        <details>
          <summary>Productos</summary>
          <a class="js-abs-href" data-href="SISTEMAS/contabilidad.html">Contabilidad</a>
          <a class="js-abs-href" data-href="SISTEMAS/bancos.html">Bancos</a>
          <a class="js-abs-href" data-href="SISTEMAS/comercialpremium.html">Comercial Premium</a>
          <a class="js-abs-href" data-href="SISTEMAS/comercialpro.html">Comercial Pro</a>
          <a class="js-abs-href" data-href="SISTEMAS/vende.html">Vende</a>
          <a class="js-abs-href" data-href="SISTEMAS/personia.html">Personia</a>
          <a class="js-abs-href" data-href="SISTEMAS/analiza.html">Analiza</a>
          <a class="js-abs-href" data-href="SISTEMAS/xmlenlinea.html">XML en L√≠nea</a>
          <a class="js-abs-href" data-href="SISTEMAS/colabora.html">Colabora</a>
        </details>

        <details>
          <summary>Servicios</summary>
          <a class="js-abs-href" data-href="SERVICIOS/implementacion.html">Implementaci√≥n</a>
          <a class="js-abs-href" data-href="SERVICIOS/capacitacion.html">Capacitaci√≥n</a>
          <a class="js-abs-href" data-href="SERVICIOS/soporte.html">Soporte</a>
          <a class="js-abs-href" data-href="SERVICIOS/desarrollos.html">Desarrollos a la medida</a>
          <a class="js-abs-href" data-href="SERVICIOS/integraciones.html">Integraciones / SDK</a>
          <a class="js-abs-href" data-href="SERVICIOS/migraciones.html">Migraciones</a>
        </details>

        <a class="js-abs-href" data-href="promociones.html">Promociones</a>
        <a class="js-abs-href" data-href="eventos-del-mes.html">Eventos del mes</a>
        <a class="js-abs-href" data-href="nosotros.html">Nosotros</a>
        <a class="js-abs-href" data-href="contacto.html">Contacto</a>
        <a href="tel:+525568437918">üìû 55 6843 7918</a>
        <a href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20informaci%C3%B3n" target="_blank" rel="noopener">üí¨ WhatsApp</a>
      </nav>
    </div>
  </aside>

  <script>
    (() => {
      const $ = (s,ctx=document)=>ctx.querySelector(s);
      const $$ = (s,ctx=document)=>Array.from(ctx.querySelectorAll(s));

      /* Burger */
      const burger = $('#gh-burger');
      const drawer = $('#gh-mobile');
      const closeBtn = $('#gh-mclose');
      const toggle = (open)=> {
        drawer.classList.toggle('open', open);
        drawer.setAttribute('aria-hidden', !open);
        document.body.style.overflow = open ? 'hidden' : '';
      };
      burger?.addEventListener('click', ()=>toggle(true));
      closeBtn?.addEventListener('click', ()=>toggle(false));
      drawer?.addEventListener('click', (e)=>{ if(e.target===drawer) toggle(false); });

      /* Activo por ruta */
      const path = location.pathname.replace(/\/index\.html?$/,'/'); 
      $$('.gh-nav a, .gh-mnav a').forEach(a=>{
        const href = a.getAttribute('href');
        if(!href) return;
        const abs = new URL(href, location.origin).pathname;
        if(abs === path) a.style.background = 'rgba(255,255,255,.08)';
      });

      /* Subnav contextual */
      const sub = $('#gh-subnav'); const inner = $('#gh-subinner');
      const anchors = [
        ['#caracteristicas','Funcionalidades'],
        ['#videos','V√≠deos'],
        ['#integra','Integraciones'],
        ['#calculadora-section','Precio'],
        ['#comparativa','Comparativa'],
        ['#faq','Preguntas frecuentes'],
        ['#sesion-guiada','Demo']
      ].filter(([id])=>document.querySelector(id));
      if(anchors.length){
        sub.style.display='block';
        inner.innerHTML = anchors.map(([id,txt])=>`<a href="${id}">${txt}</a>`).join('');
      }

      /* Accesibilidad */
      $$('.gh-has-dd > a').forEach(trigger=>{
        const dd = trigger.parentElement.querySelector('.gh-dd');
        trigger.addEventListener('keydown', (e)=>{
          if(e.key==='ArrowDown'){ e.preventDefault(); dd?.querySelector('a,button,summary')?.focus(); }
        });
      });

      /* ===== Resolver rutas (repoBase-aware) ===== */
      const isGh = location.hostname.endsWith("github.io");
      const firstSeg = location.pathname.split("/")[1] || "";
      const repoBase = (isGh && firstSeg) ? ("/"+firstSeg) : "";
      const abs = (p) => (repoBase + "/" + p).replace(/\/+/g,"/");

      // <a class="js-abs-href" data-href="...">
      $$('.js-abs-href[data-href]').forEach(a=>{
        const p = a.getAttribute('data-href');
        // Permite hashes tipo "index.html#productos"
        const [base, hash] = p.split('#');
        a.href = abs(base) + (hash ? ('#'+hash) : '');
      });

      // <img class="js-abs-src" data-src="...">
      $$('.js-abs-src[data-src]').forEach(img=>{
        img.src = abs(img.getAttribute('data-src'));
      });
    })();
  </script>
</header>

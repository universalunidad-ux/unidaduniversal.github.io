<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>CONTPAQi XML en Línea | Expiriti</title>
<meta name="description" content="CONTPAQi XML en Línea con Expiriti: Descarga masiva de CFDI del SAT, valida EFOS, organiza y administra tus XML fácilmente.">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

<link rel="apple-touch-icon" sizes="180x180" href="../IMG/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="../IMG/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="../IMG/favicon-16x16.png">
<link rel="manifest" href="../IMG/site.webmanifest">
<link rel="icon" href="../IMG/favicon.ico">
<link rel="icon" type="image/png" sizes="192x192" href="../IMG/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="../IMG/android-chrome-512x512.png">

<style>
:root{
  --bg:#0b0f14;--card:#111723;--muted:#95a2b3;--text:#e8eef6;
  --brand:#2dd4bf;--brand-2:#60a5fa;--ok:#22c55e;--warn:#f59e0b;--err:#ef4444;
  --maxw:1200px;--radius:14px;--shadow:0 10px 30px rgba(0,0,0,.25)
}
*{box-sizing:border-box}
html,body{margin:0;height:100%}
html{scroll-behavior:smooth}
body{
  font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
  background:linear-gradient(180deg,#0b0f14 0%, #0d1219 100%); color:var(--text);
  scroll-padding-top:84px;
}
a{color:inherit;text-decoration:none}
img,video,iframe{max-width:100%;display:block}
.container{max-width:var(--maxw);margin:0 auto;padding:0 34px}

/* Header fijo */
header{
  position:sticky; top:0; z-index:1000; width:100%;
  background:rgba(11,15,20,.75); backdrop-filter:saturate(140%) blur(8px);
  border-bottom:1px solid #19202b;
}
.nav{display:flex;align-items:center;justify-content:space-between;gap:16px;padding:12px 0}
.brand{display:flex;align-items:center;gap:10px;font-weight:700}
.brand img{width:38px;height:38px;border-radius:10px;display:block}
.brand small{display:block;font-weight:500;color:var(--muted);font-size:12px;margin-top:2px}
nav ul{list-style:none;display:flex;gap:18px;margin:0;padding:0}
nav a{opacity:.9} nav a:hover{opacity:1}
.cta{display:flex;gap:10px;align-items:center}
.burger{display:none}

/* Botones */
.btn{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:8px 12px;border-radius:999px;border:1px solid #1c2533;background:#121a25;box-shadow:var(--shadow);font-weight:700;font-size:14px;cursor:pointer;white-space:nowrap}
.btn-grad-green{background:linear-gradient(145deg,#16a34a,#22c55e);color:#0b0f14;border:none}
.btn-grad-purple{background:linear-gradient(145deg,#7c3aed,#a855f7);color:#fff;border:none}
.btn-grad-blue{background:linear-gradient(145deg,#2563eb,#3b82f6);color:#fff;border:none}
.btn-ghost{background:#121a25;color:#e8eef6}
.btn-outline-gradient{color:#cfe9ff;background:transparent;border:1px solid transparent;position:relative;overflow:hidden}
.btn-outline-gradient::before{content:"";position:absolute;inset:0;padding:1px;border-radius:12px;background:linear-gradient(145deg,var(--brand),var(--brand-2));-webkit-mask:linear-gradient(#000 0 0) content-box,linear-gradient(#000 0 0);-webkit-mask-composite:xor;mask-composite:exclude}

/* Títulos / badges */
.hero{padding:26px 0 0}
h1{font-size:clamp(28px,3.4vw,42px);line-height:1.1;margin:8px 0 14px}
h2,h3,h4{margin:0 0 10px}
.lead{color:#c6d1e3;font-size:18px;max-width:68ch}
.hint{color:#aebbd0;opacity:.9}
.badges{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0 0}
.badge{display:inline-block;padding:6px 10px;border-radius:999px;background:#0f1c2c;border:1px solid #203044;color:#cfe3ff;font-size:12px}
.lock-note{margin:8px 0 0;font-size:12px;color:#94a8c6;display:inline-flex;gap:6px;align-items:center}
.lock-note::before{content:"⚠️";}
section{padding:26px 0;border-top:1px solid #11182725}
.card{background:var(--card);border:1px solid #1c2533;border-radius:16px;overflow:hidden}
.card .body{padding:12px;color:#c8d3e5}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:14px;align-items:start}
.grid-2.align-center{align-items:center}
.grid-3{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.stack{display:grid;gap:12px}
.title-gradient{background:linear-gradient(90deg,var(--brand),var(--brand-2));-webkit-background-clip:text;background-clip:text;color:transparent}

/* ===== HERO 3 columnas ===== */
.hero-3col{display:grid;grid-template-columns:280px 1.55fr 1.05fr;column-gap:8px;align-items:start}
@media (max-width:1200px){ .hero-3col{grid-template-columns:270px 1.45fr 1.05fr} }
@media (max-width:980px){ .hero-3col{grid-template-columns:1fr} }
.stack-left{display:grid;gap:10px;align-items:start;justify-items:start}
.pdf-card{margin-left:-6px}
.pdf-frame{width:100%;height:68vh;border:0}
@media (max-width:980px){ .pdf-frame{height:56vh} }

/* Botones Hero (hover) */
.hero-btn {transition: transform .2s ease, box-shadow .2s ease, background .2s ease, border-color .2s ease}
.hero-btn:hover {transform: translateY(-3px); box-shadow: 0 10px 26px rgba(0,0,0,.35)}
.hero-btn.btn-grad-green:hover {box-shadow: 0 10px 26px rgba(34,197,94,.3)}
.hero-btn.btn-grad-purple:hover {box-shadow: 0 10px 26px rgba(168,85,247,.3)}
.hero-btn.btn-grad-blue:hover {box-shadow: 0 10px 26px rgba(59,130,246,.3)}
.hero-btn.btn-ghost:hover {background:#192636;border-color:#2a3c52}

/* ===== Galería portada ===== */
.carousel{position:relative;border-radius:var(--radius);overflow:hidden;border:1px solid #1c2533;background:#0f1622;min-height:420px}
.carousel-track{display:flex;scroll-snap-type:x mandatory;overflow-x:auto;scroll-behavior:smooth;height:calc(100% - 38px)}
.carousel-slide{min-width:100%;width:100%;height:100%;object-fit:cover;display:block;flex-shrink:0}
.carousel-nav{display:flex;gap:8px;justify-content:center;padding:10px;background:#0e1724;border-top:1px solid #1c2533}
.dot{width:10px;height:10px;border-radius:999px;background:#223044;border:none;opacity:.6}
.dot.active{background:linear-gradient(145deg,var(--brand),var(--brand-2));opacity:1}
.arrowCircle{position:absolute;top:50%;transform:translateY(-50%);width:44px;height:44px;border-radius:999px;border:1px solid #2b3c56;background:linear-gradient(145deg,#0f1a2a,#0f1c2c);display:grid;place-items:center;cursor:pointer;z-index:3;color:#eaf2ff;box-shadow:0 6px 18px rgba(0,0,0,.35)}
.arrowCircle.prev{left:8px}.arrowCircle.next{right:8px}.arrowCircle .chev{font-size:24px;line-height:1}

/* ===== Carrusel de sistemas ===== */
.carouselX{position:relative;border-radius:16px;background:#0e1826;border:1px solid #1c2533;padding:8px}
.carouselX .track{display:flex;gap:12px;overflow:hidden;padding:4px;min-height:220px}
.carouselX .sys{flex:0 0 calc((100% - 24px)/3);background:#0f1622;border:1px solid #1c2533;border-radius:14px;padding:16px;display:flex;flex-direction:column;align-items:center;text-align:center}
.carouselX .sys img{width:72px;height:72px;border-radius:16px;margin:6px auto 10px;background:#101826;object-fit:cover}
.group-dots{display:flex;gap:8px;justify-content:center;margin:8px 0 0 0}
.group-dots .dot.active{background:linear-gradient(145deg,var(--brand),var(--brand-2))}

/* ===== CALCULADORA ===== */
.calc-strip{display:flex;flex-direction:column;gap:12px}
.calc-row{display:grid;grid-template-columns:1fr 1fr;gap:14px;align-items:stretch}
.calc-row.has-three{grid-template-columns:1fr 1fr 1fr}
.calc-container{border:1px solid #1c2533;border-radius:12px;background:#0f1622;padding:12px}
.placeholder{border:1px dashed #26405f;background:#0e1724;border-radius:12px;display:flex;align-items:center;justify-content:center;padding:14px;min-height:180px}
.placeholder .note{text-align:center;color:#b9c8de}
#calc-primary{grid-column:1}
#calc-slot-2,#calc-secondary{grid-column:2}
#calc-tertiary{grid-column:3;display:none}
#add-more-panel{grid-column:1 / -1}

.calc-container h4{margin:0 0 8px}
.calc-container table{width:100%;max-width:640px;margin:0 auto;border-collapse:separate;border-spacing:0;border:1px solid #1e2b3c;border-radius:10px;overflow:hidden;background:#0e1724}
.calc-container thead th{background:#0e1724;color:#dce8ff;text-align:left;border-bottom:1px solid #1e2b3c;font-weight:700}
.calc-container th,.calc-container td{padding:10px 12px;border-bottom:1px solid #1e2b3c}
.calc-container tr:last-child td{border-bottom:none}
.calc-container td:last-child,.calc-container th:last-child{text-align:right}
.calc-container label,.calc-container .control-label{display:block;font-weight:700;color:#cfe3ff;margin:4px 0 4px}
.calc-container select,.calc-container input[type="number"]{width:100%;display:block;padding:8px 10px;border-radius:10px;border:1px solid #243248;background:#0e1724;color:#e8eef6}

/* ===== Pickers: grid 3×N y responsive ===== */
.icons-wrap{
  display:grid !important;
  grid-template-columns: repeat(3, minmax(128px, 1fr)) !important;
  gap:12px !important;
  justify-items:center !important;
}
@media (max-width:980px){
  .icons-wrap{ grid-template-columns: repeat(3, minmax(120px, 1fr)) !important; }
}
@media (max-width:680px){
  .icons-wrap{ grid-template-columns: repeat(2, minmax(120px, 1fr)) !important; }
}
.icons-wrap .sys-icon{
  width:100% !important; padding:10px; border-radius:12px;
  border:1px solid #1e2b3c; background:#0e1724; cursor:pointer;
  display:grid; grid-template-rows:auto auto auto; justify-items:center; row-gap:6px;
  transition:transform .12s ease, box-shadow .12s ease, border-color .15s ease, outline-color .12s ease;
}
.icons-wrap .sys-icon:hover{transform:translateY(-2px);box-shadow:0 10px 22px rgba(0,0,0,.25);border-color:#274061}
.icons-wrap .sys-icon.active{outline:2px solid var(--brand)}
.icons-wrap .sys-icon img{width:56px;height:56px;border-radius:12px}
.icons-wrap .sys-icon strong{font-size:12px;text-align:center}
.icons-wrap .sys-icon .sys-price{color:#9fb2cb;font-size:11px}
.icons-wrap .sys-icon .sin15,
.icons-wrap .sys-icon .sin-15{
  font-size:10px;font-weight:700;padding:2px 6px;border:1px solid #1e2b3c;border-radius:999px;
  background:#0e1724;color:#cfe3ff;justify-self:end
}

/* ===== Comparativa / FAQ / Footer ===== */
.table-like{width:100%;border-collapse:separate;border-spacing:0;border:1px solid #1e2b3c;border-radius:12px;overflow:hidden}
.table-like th,.table-like td{padding:12px 14px;border-bottom:1px solid #1e2b3c}
.table-like tr:last-child td{border-bottom:none}
.table-like thead th{background:#0e1724;color:#dce8ff;text-align:left}
.table-like .highlight{background:rgba(45,212,191,.08);font-weight:700}

.toc{position:fixed;right:16px;bottom:16px;width:240px;max-height:48vh;overflow:auto;background:rgba(15,24,38,.75);border:1px solid #1c2533;border-radius:14px;padding:12px;display:flex;flex-direction:column;gap:6px;z-index:900;box-shadow:0 10px 24px rgba(0,0,0,.35);backdrop-filter: blur(6px);transition:all .2s ease}
.toc.collapsed{width:auto;max-height:none;padding:6px 10px;border-radius:999px;gap:0}
.toc.collapsed .toc-title,.toc.collapsed a,.toc.collapsed .toc-close{display:none}
.toc-title{font-weight:800;color:#b9c8de;margin-bottom:6px}
.toc a{padding:6px 8px;border-radius:10px;color:#cfe3ff;border:1px solid transparent}
.toc a:hover{border-color:#233347;background:#101b2a}

.faq-wrap{display:grid;gap:10px}
.faq-item{border:1px solid #1e2b3c;border-radius:12px;background:#0f1622;overflow:hidden}
.faq-item>summary{list-style:none;cursor:pointer;padding:12px 14px;font-weight:700;display:flex;align-items:center;gap:8px}
.faq-item>summary::marker{display:none}
.faq-item[open]>summary{background:#0e1724;border-bottom:1px solid #1e2b3c}
.faq-item p{padding:12px 14px;margin:0;color:#cfe3ff}

footer{padding:36px 0 12px;border-top:1px solid #11182725;color:#aebbd0}
.footer-grid{display:grid;gap:18px;grid-template-columns:1.6fr 1.2fr 1.2fr 1fr}
.footer-title{font-weight:700;color:#d8e3f6;margin:0 0 10px}
.contact-list{display:grid;gap:6px;font-size:14px}
.item .ico{width:22px}
.payments-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:12px;align-items:center}
.payments-grid img{max-height:28px;object-fit:contain;filter:grayscale(1);opacity:.9}
.brands-col{display:grid;gap:10px}
.brand-item img{max-height:26px;object-fit:contain;filter:grayscale(.1);background:#0e1520;border:1px solid #1c2533;border-radius:10px;padding:6px}
.ally-col{display:grid;gap:10px;justify-items:end}
.ally-col img{height:46px;object-fit:contain;background:#0e1520;border:1px solid #1c2533;border-radius:10px;padding:8px}
.footer-bottom{display:flex;flex-wrap:wrap;gap:12px;align-items:center;justify-content:space-between;margin-top:20px;padding-top:12px;border-top:1px solid #1c2533}

/* Responsive generales */
@media (max-width:980px){
  .grid-2{grid-template-columns:1fr}
  .grid-3{grid-template-columns:1fr}
  nav ul{display:none}
  .burger{display:inline-flex;align-items:center;justify-content:center;width:42px;height:42px;border-radius:10px;border:1px solid #1c2533;background:#101722}
  .mobile{display:none}.mobile.open{display:block}
  .mobile a{display:block;padding:12px 0;border-bottom:1px solid #1c2533}
  .toc{right:10px;bottom:10px;width:86vw}
  .footer-grid{grid-template-columns:1fr}
}

/* ===== Funciones destacadas ===== */
.pillbar{display:flex;flex-wrap:wrap;gap:10px;margin:10px 0 14px}
.pill{
  padding:8px 12px;border-radius:999px;
  border:1px solid #1e2b3c;background:linear-gradient(180deg,#0f1c2c,#0e1724);
  color:#cfe3ff;cursor:pointer;font-weight:700;font-size:13px;
  transition:transform .12s ease, box-shadow .12s ease, background .2s ease
}
.pill:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.25)}
.pill.active{background:linear-gradient(145deg,var(--brand),var(--brand-2));color:#0b0f14;border:none}

/* Grid de features 3 col */
.feature-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px}
@media (max-width:980px){ .feature-grid{grid-template-columns:1fr 1fr} }
@media (max-width:680px){ .feature-grid{grid-template-columns:1fr} }
.fcard{border:1px solid #1e2b3c;border-radius:14px;background:linear-gradient(180deg,#0f1622,#0f1724);padding:14px;display:grid;gap:8px;transition:transform .12s ease, box-shadow .12s ease, border-color .15s ease}
.fcard:hover{transform:translateY(-2px);box-shadow:0 10px 24px rgba(0,0,0,.25);border-color:#284061}
.fhead{display:flex;align-items:center;gap:10px}
.ficon{width:28px;height:28px;border-radius:8px;background:#0e1724;border:1px solid #1e2b3c;object-fit:cover}
.fcard h4{margin:0;font-size:15px}
.fcard p{margin:0;color:#bcd0ea;font-size:14px;line-height:1.35}

/* ===== “¿Por qué usar…?” — slider ===== */
.listSlider{position:relative;border-radius:16px;background:linear-gradient(180deg,#0e1826,#0f1622);border:1px solid #1c2533;padding:8px;overflow:hidden}
.listTrack{display:flex;overflow:hidden;scroll-behavior:smooth}
.listPage{min-width:100%;padding:8px}
.listItem{display:grid;grid-template-columns:84px 1fr;gap:14px;align-items:center;background:#0f1c2c;border:1px solid #152437;border-radius:14px;margin:10px 4px;padding:14px;transition:border-color .15s ease, transform .12s ease}
.listItem:hover{border-color:#254064;transform:translateY(-1px)}
.listIcon{width:84px;height:84px;border-radius:14px;background:#0f1725;display:grid;place-items:center;overflow:hidden}
.listIcon img{width:84px;height:84px;object-fit:cover}
.listItem strong{display:block;font-size:14px;margin-bottom:2px}
.listItem div>div{font-size:13px;color:#b9c8de;line-height:1.35}
#beneficios .arrowCircle{width:40px;height:40px}
#beneficios .arrowCircle .chev{font-size:22px}

/* Tercera calculadora oculta */
#calc-tertiary{display:none}

/* ===== Videos (horizontales) ===== */
.yt-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;align-items:center;justify-items:center}
@media (max-width:768px){ .yt-grid{grid-template-columns:1fr} }
.yt{width:100%;max-width:680px}
.yt iframe{aspect-ratio:16/9;width:100%;border:1px solid #1c2533;border-radius:12px;background:#0e1724}
</style>
</head>
<body id="top">
<header>
  <div class="container nav">
    <a href="#top" class="brand" aria-label="Inicio Expiriti">
      <img src="../IMG/expiritilogo.webp" alt="Expiriti">
      <div>Expiriti<small>Distribuidor CONTPAQi</small></div>
    </a>
    <nav aria-label="Principal">
      <ul>
        <li><a href="#caracteristicas">Por qué CONTPAQi?</a></li>
        <li><a href="#videos">Vídeos</a></li>
        <li><a href="#calculadora-section">Precio</a></li>
        <li><a href="#comparativa">Comparativa</a></li>
        <li><a href="#faq">Preguntas frecuentes</a></li>
        <li><a href="#sesion-guiada">Demo</a></li>
      </ul>
    </nav>
    <div class="cta">
      <a class="btn btn-ghost" href="tel:+525568437918">55 6843 7918</a>
      <a class="btn btn-ghost" href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20informaci%C3%B3n%20de%20CONTPAQi%20XML%20en%20L%C3%ADnea" target="_blank" rel="noopener">WhatsApp</a>
      <button class="burger" id="burger" aria-label="Abrir menú">≡</button>
    </div>
  </div>
  <div class="container mobile" id="mobileMenu">
    <a href="#caracteristicas">Por qué CONTPAQi?</a>
    <a href="#videos">Vídeos</a>
    <a href="#calculadora-section">Precio</a>
    <a href="#comparativa">Comparativa</a>
    <a href="#faq">Preguntas frecuentes</a>
    <a href="#sesion-guiada">Demo</a>
  </div>
</header>

<main class="container hero">
  <a class="hint" href="https://universalunidad-ux.github.io/unidaduniversal.github.io/#productos">← Volver a productos</a>
  <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
  <h1>CONTPAQi XML en Línea <span class="badge">Actualizado 2025</span></h1>

  <div class="badges">
    <span class="badge">Descarga Masiva CFDI del SAT</span>
    <span class="badge">Validación Automática (EFOS)</span>
    <span class="badge">Organización en ADD</span>
    <span class="badge">Búsqueda Avanzada y Reportes</span>
  </div>
  <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>

  <section aria-label="Resumen">
    <div class="card body">
      <div class="hero-3col">
        <div class="stack-left">
          <img src="../IMG/xml.webp" alt="CONTPAQi XML en Línea" style="width:220px;margin-bottom:12px;border-radius:12px">
          <div class="stack">
            <a class="btn btn-grad-green hero-btn" href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20comprar%20mi%20licencia%20de%20CONTPAQi%20XML%20en%20L%C3%ADnea" target="_blank" rel="noopener">Compra ahora</a>
            <a class="btn btn-grad-purple hero-btn" href="https://wa.me/5568437918?text=Quiero%20tramitar%20mi%20prueba%20de%2030%20d%C3%ADas%20de%20CONTPAQi%20XML%20en%20L%C3%ADnea" target="_blank" rel="noopener">Tramitar prueba 30 días</a>
            <a class="btn btn-grad-blue hero-btn" href="#sesion-guiada">Sesión guiada 45 min por Zoom</a>
            <a class="btn btn-ghost hero-btn" href="../PDFS/Ficha_XML_Linea.pdf" target="_blank" rel="noopener">Ficha técnica (PDF)</a>
            <a class="btn btn-ghost hero-btn" href="#caracteristicas">Resumen ficha técnica</a>
          </div>
        </div>

        <div class="card body pdf-card">
          <img src="../IMG/usas.jpeg" alt="Uso del sistema" style="width:100%;border-radius:10px;margin-bottom:10px">
          <h4 class="title-gradient" style="margin:0 0 6px">Gestión inteligente de XML del SAT</h4>
          <p class="hint" style="margin:0 0 8px">Descarga masiva, valida EFOS y organiza todo en el ADD para contabilidad y auditoría.</p>
          <iframe class="pdf-frame" title="Ficha técnica XML en Línea" src="../PDFS/Ficha_XML_Linea.pdf#page=2&view=FitH"></iframe>
          <div style="display:flex;gap:8px;flex-wrap:wrap;justify-content:center;margin-top:8px">
            <a class="btn btn-outline-gradient" href="../PDFS/Ficha_XML_Linea.pdf" target="_blank" rel="noopener">Abrir en pestaña</a>
            <a class="btn btn-outline-gradient" href="../PDFS/Ficha_XML_Linea.pdf" download>Descargar</a>
          </div>
        </div>

        <aside class="card body">
          <h4 class="title-gradient">Galería</h4>
          <div class="carousel" id="carousel1">
            <button class="arrowCircle prev" aria-label="Anterior"><span class="chev">‹</span></button>
            <div class="carousel-track">
              <img class="carousel-slide" src="../IMG/1xml_placeholder.webp" alt="Descarga masiva desde el SAT">
              <img class="carousel-slide" src="../IMG/2xml_placeholder.webp" alt="Validación automática de EFOS">
              <img class="carousel-slide" src="../IMG/3xml_placeholder.webp" alt="Organización en el ADD">
              <img class="carousel-slide" src="../IMG/4xml_placeholder.webp" alt="Búsqueda avanzada de CFDI">
            </div>
            <button class="arrowCircle next" aria-label="Siguiente"><span class="chev">›</span></button>
            <div class="carousel-nav">
              <button class="dot active" aria-label="Ir a la imagen 1"></button>
              <button class="dot" aria-label="Ir a la imagen 2"></button>
              <button class="dot" aria-label="Ir a la imagen 3"></button>
              <button class="dot" aria-label="Ir a la imagen 4"></button>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>

  <section id="caracteristicas" aria-labelledby="caracteristicas-title">
    <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
    <div class="card body">
      <h3 id="caracteristicas-title" class="title-gradient">Funciones destacadas</h3>

      <div class="pillbar" role="tablist" aria-label="Categorías de características">
        <button class="pill active" data-filter="descarga">Descarga y Validación SAT</button>
        <button class="pill" data-filter="gestion">Gestión y Organización</button>
        <button class="pill" data-filter="integracion">Integración y Reportes</button>
      </div>

      <div class="grid-3 feature-grid">
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_descarga_masiva.webp" alt=""><h4>Descarga Masiva</h4></div><p>Baja hasta 200,000 XML por solicitud del portal SAT (Web Service).</p></article>
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_efos.webp" alt=""><h4>Validación EFOS</h4></div><p>Verifica automáticamente si tus proveedores están en listas negras del SAT (Art. 69-B).</p></article>
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_validacion_sat.webp" alt=""><h4>Validación Estructura</h4></div><p>Comprueba la estructura, sello y cadena original de los CFDI.</p></article>
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_check.webp" alt=""><h4>Verificación Estado</h4></div><p>Consulta el estado del CFDI en el SAT (Vigente/Cancelado).</p></article>
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_programar.webp" alt=""><h4>Descargas Programadas</h4></div><p>Automatiza la descarga periódica de tus comprobantes.</p></article>
        <article class="fcard tag-descarga"><div class="fhead"><img class="ficon" src="../IMG/ic_multi_rfc.webp" alt=""><h4>Múltiples RFC</h4></div><p>Gestiona la descarga y administración para varios contribuyentes.</p></article>

        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_add.webp" alt=""><h4>Administrador de Documentos (ADD)</h4></div><p>Centraliza y organiza todos tus XML recibidos y emitidos.</p></article>
        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_buscar.webp" alt=""><h4>Búsqueda Avanzada</h4></div><p>Filtra y encuentra CFDI por RFC, fecha, importe, folio, UUID, etc.</p></article>
        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_clasificar.webp" alt=""><h4>Clasificación</h4></div><p>Organiza tus XML por tipo (Ingreso, Egreso, Pago, Nómina, etc.).</p></article>
        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_pdf.webp" alt=""><h4>Generación PDF</h4></div><p>Crea representaciones impresas (PDF) de tus CFDI.</p></article>
        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_exportar.webp" alt=""><h4>Exportación a Excel®</h4></div><p>Exporta listados y detalles de tus XML para análisis.</p></article>
        <article class="fcard tag-gestion"><div class="fhead"><img class="ficon" src="../IMG/ic_storage.webp" alt=""><h4>Almacenamiento Seguro</h4></div><p>Resguarda tus comprobantes fiscales digitales de forma segura.</p></article>

        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_contabiliza.webp" alt=""><h4>Integración Contable</h4></div><p>Se conecta con CONTPAQi Contabilidad y Bancos para cargar XML al ADD.</p></article>
        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_concilia.webp" alt=""><h4>Conciliación vs Pagos</h4></div><p>Ayuda a identificar CFDI pendientes de pago o cobro.</p></article>
        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_reportes.webp" alt=""><h4>Reportes Detallados</h4></div><p>Genera reportes de descargas, validaciones, EFOS, etc.</p></article>
        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_auditoria.webp" alt=""><h4>Auditoría Fácil</h4></div><p>Facilita la revisión y auditoría de tus comprobantes fiscales.</p></article>
        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_usuarios.webp" alt=""><h4>Control de Usuarios</h4></div><p>Define permisos y accesos para diferentes usuarios.</p></article>
        <article class="fcard tag-integracion"><div class="fhead"><img class="ficon" src="../IMG/ic_log.webp" alt=""><h4>Bitácora de Descargas</h4></div><p>Lleva un registro detallado de todas las descargas realizadas.</p></article>
      </div>
    </div>
  </section>

  <section id="beneficios" aria-label="Por qué usar">
    <div class="grid-2 align-center">
      <div>
        <h2 class="title-gradient">¿Por qué usar XML en Línea? <span class="badge">Beneficios clave</span></h2>
        <p class="lead">Ahorra tiempo y evita riesgos fiscales descargando y validando automáticamente todos tus CFDI directamente del SAT.</p>
        <div class="listSlider">
          <button class="arrowCircle prev"><span class="chev">‹</span></button>
          <div class="listTrack">
            <div class="listPage">
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_descarga_masiva.webp" alt=""></div><div><strong>AHORRA HORAS DE TRABAJO</strong><div>Descarga masiva automática, olvídate del portal del SAT.</div></div></div>
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_efos_check.webp" alt=""></div><div><strong>EVITA RIESGOS (EFOS)</strong><div>Validación automática contra listas negras (Art. 69-B).</div></div></div>
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_add_organizado.webp" alt=""></div><div><strong>ORGANIZA TUS XML</strong><div>Centraliza y encuentra fácilmente cualquier CFDI en el ADD.</div></div></div>
            </div>
            <div class="listPage">
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_seguridad.webp" alt=""></div><div><strong>SEGURIDAD Y CONTROL</strong><div>Verifica validez, estado y almacena tus CFDI de forma segura.</div></div></div>
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_integracion_contpaqi.webp" alt=""></div><div><strong>INTEGRACIÓN CONTPAQi</strong><div>Complemento ideal para Contabilidad, Bancos y Comercial.</div></div></div>
              <div class="listItem"><div class="listIcon"><img src="../IMG/ic_multiempresa.webp" alt=""></div><div><strong>IDEAL PARA DESPACHOS</strong><div>Administra múltiples RFC desde una sola herramienta.</div></div></div>
            </div>
          </div>
          <button class="arrowCircle next"><span class="chev">›</span></button>
        </div>
      </div>
      <div>
        <aside class="card body">
          <h4 class="title-gradient" style="margin-bottom:8px;">Reels Destacados: XML en Línea</h4>
          <div class="carousel" id="carouselReels">
            <button class="arrowCircle prev" aria-label="Anterior"><span class="chev">‹</span></button>
            <div class="carousel-track">
              <div class="carousel-slide" style="display:flex;justify-content:center;align-items:center;padding:10px;box-sizing:border-box;">
                <iframe
                  src="https://www.youtube-nocookie.com/embed/IWqSb2Ycmvc?rel=0&modestbranding=1&controls=1&fs=1"
                  title="Reel CONTPAQi XML en Línea"
                  frameborder="0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                  allowfullscreen
                  style="border-radius:12px; aspect-ratio:9/16; width:300px; max-width:100%;">
                </iframe>
              </div>
            </div>
            <button class="arrowCircle next" aria-label="Siguiente"><span class="chev">›</span></button>
            <div class="carousel-nav" aria-label="Paginación de galería">
              <button class="dot active" aria-label="Ir al reel 1"></button>
            </div>
          </div>
        </aside>
      </div>
    </div>
  </section>

<section id="videos" aria-labelledby="videos-title">
  <div class="card body">
    <h3 id="videos-title" class="title-gradient">Videos del sistema</h3>
    <div class="yt-grid">
      <div class="yt">
        <h4 style="margin-bottom: 8px; text-align: center;">Presentación CONTPAQi XML en Línea</h4>
        <div style="text-align:center;">
          <iframe width="560" height="315"
            src="https://www.youtube-nocookie.com/embed/jb5s7v300Ig?rel=0&modestbranding=1&controls=1&fs=1"
            title="Presentación CONTPAQi XML en Línea (para accesibilidad)"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            style="border-radius:12px; max-width:100%; display:block; margin:auto;"
            loading="lazy">
          </iframe>
        </div>
      </div>
      <div class="yt">
        <h4 style="margin-bottom: 8px; text-align: center;">Demo CONTPAQi XML en Línea</h4>
        <div style="text-align:center;">
          <iframe width="560" height="315"
            src="https://www.youtube-nocookie.com/embed/AWgBjiuENfc?rel=0&modestbranding=1&controls=1&fs=1"
            title="Demo CONTPAQi XML en Línea (para accesibilidad)"
            frameborder="0"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen
            style="border-radius:12px; max-width:100%; display:block; margin:auto;"
            loading="lazy">
          </iframe>
        </div>
      </div>
    </div>
  </div>
</section>

  <section id="integra" aria-labelledby="integra-title">
    <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
    <h3 id="integra-title" class="title-gradient">Sistemas que complementan tu XML en Línea</h3>
    <div class="card body">
      <div class="carouselX" data-step="3">
        <button class="arrowCircle prev"><span class="chev">‹</span></button>
        <div class="track">
          <article class="sys"><img src="../IMG/contabilidad.webp" alt="Contabilidad" /><h4>CONTPAQi Contabilidad</h4><p>Carga los XML descargados al ADD y genera pólizas.</p></article>
          <article class="sys"><img src="../IMG/bancos.webp" alt="Bancos" /><h4>CONTPAQi Bancos</h4><p>Utiliza los XML para conciliar movimientos bancarios.</p></article>
          <article class="sys"><img src="../IMG/comercialpremium.webp" alt="Comercial Premium" /><h4>Comercial Premium</h4><p>Importa CFDI de proveedores para gestión de compras.</p></article>
          <article class="sys"><img src="../IMG/nominas.webp" alt="Nóminas" /><h4>CONTPAQi Nóminas</h4><p>Valida y organiza los CFDI de nómina emitidos.</p></article>
          <article class="sys"><img src="../IMG/comercialpro.webp" alt="Comercial Pro" /><h4>Comercial Pro</h4><p>Asocia CFDI de gastos a tus operaciones comerciales.</p></article>
        </div>
        <button class="arrowCircle next"><span class="chev">›</span></button>
        <div class="group-dots"></div>
      </div>
    </div>
  </section>

  <section id="calculadora-section" aria-labelledby="calc">
    <h3 id="calc" class="title-gradient">Conoce el precio de tu licencia</h3>
    <p class="hint" style="text-align:center;">Nota: CONTPAQi XML en Línea generalmente no aplica para descuentos por paquete.</p>
    <div class="calc-strip">
      <div id="app" data-system="CONTPAQi XML en Línea" hidden></div>
      <div class="calc-row" id="calc-row">
        <div id="calc-primary" class="calc-container" aria-label="Calculadora principal"></div>

        <div id="calc-slot-2" class="placeholder">
          <div class="note">
            <strong>Integra XML en Línea con otros sistemas CONTPAQi.</strong><br>
            <small>Selecciona un sistema para ver precios combinados (XML no suele tener descuento).</small>
            <div class="icons-wrap" id="icons-sec-sys"></div>
          </div>
        </div>

        <div id="calc-tertiary" class="calc-container" aria-label="Tercera calculadora"></div>

        <div id="add-more-panel" class="placeholder" style="display:none">
          <div class="note">
            <strong>¿Agregar un tercer sistema?</strong><br>
            <small>Calcula el precio total de tu paquete.</small>
            <div class="icons-wrap" id="icons-third-sys"></div>
          </div>
        </div>
      </div>

      <div id="combined-wrap" class="combined-card" hidden>
        <h4 class="title-gradient">Resumen combinado</h4>
        <table class="combined-table"><tbody id="combined-table-body"></tbody></table>
      </div>
    </div>
  </section>

  <section id="comparativa" aria-labelledby="comparativa-title">
    <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
    <h3 id="comparativa-title" class="title-gradient">Comparativa con otras opciones</h3>
    <div class="card body">
      <table class="table-like">
        <thead><tr><th>Característica</th><th class="highlight">CONTPAQi XML en Línea</th><th>Descarga Manual SAT</th><th>Otras Herramientas</th><th>Servicio Externo</th></tr></thead>
        <tbody>
          <tr><td>Descarga Masiva Web Service</td><td class="highlight">✅ (200k / solicitud)</td><td>❌ Limitada / Captchas</td><td>⚠️ Variable / Limitada</td><td>✅ (Depende del proveedor)</td></tr>
          <tr><td>Validación EFOS Automática</td><td class="highlight">✅ Integrada</td><td>❌ Manual</td><td>⚠️ Algunas sí / Costo extra</td><td>⚠️ Variable</td></tr>
          <tr><td>Organización en ADD</td><td class="highlight">✅ Centralizada</td><td>❌ Manual / Carpetas</td><td>❌ Sistema propio / No ADD</td><td>❌ No aplica</td></tr>
          <tr><td>Integración CONTPAQi</td><td class="highlight">✅ Nativa</td><td>❌ Manual</td><td>❌ No / Layouts</td><td>❌ Manual</td></tr>
        </tbody>
      </table>
    </div>
  </section>

  <section id="faq" aria-labelledby="faq-title">
    <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
    <h3 id="faq-title" class="title-gradient">Preguntas frecuentes</h3>
    <div class="faq-wrap" id="faqWrap">
      <details class="faq-item"><summary>¿Cuántos XML puedo descargar del SAT con esta herramienta?</summary><p>Puedes descargar hasta 200,000 XML por solicitud utilizando la conexión Web Service del SAT, superando ampliamente el límite de 2,000 diarios de la descarga manual.</p></details>
      <details class="faq-item"><summary>¿Cómo funciona la validación de EFOS (listas negras)?</summary><p>El sistema cruza automáticamente los RFC de los emisores de tus CFDI descargados contra las listas actualizadas del SAT (Art. 69-B). Te alerta si encuentras operaciones con Empresas que Facturan Operaciones Simuladas.</p></details>
      <details class="faq-item"><summary>¿Necesito tener otros sistemas CONTPAQi para usar XML en Línea?</summary><p>No es estrictamente necesario, puedes usarlo de forma independiente para descargar y administrar tus XML. Sin embargo, se integra perfectamente con Contabilidad, Bancos y Comercial para cargar los XML directamente al ADD de esos sistemas.</p></details>
      <details class="faq-item"><summary>¿Puedo administrar los XML de varias empresas (RFC)?</summary><p>Sí, la herramienta está diseñada para manejar múltiples RFC, lo que la hace ideal para contadores y despachos que gestionan la información fiscal de diversos clientes.</p></details>
      <details class="faq-item"><summary>¿La licencia incluye actualizaciones?</summary><p>Sí, al adquirir la licencia (generalmente anual), tienes derecho a todas las actualizaciones que se liberen durante la vigencia, asegurando compatibilidad con cambios del SAT.</p></details>
    </div>
  </section>

  <section id="sesion-guiada" class="card body">
    <div class="lock-note">no borrar esta sección, no tocar, respetar y mantener integro</div>
    <h3 class="title-gradient">¿Listo para empezar?</h3>
    <p>Agenda una sesión con nuestros especialistas o tramita tu prueba sin costo.</p>
    <div style="display:flex;gap:10px;flex-wrap:wrap;justify-content:center">
      <a class="btn btn-grad-blue" href="https://wa.me/5568437918?text=Hola%21%20Quiero%20agendar%20una%20sesi%C3%B3n%20guiada%20de%2045%20minutos%20por%20Zoom%20para%20XML%20en%20L%C3%ADnea" target="_blank" rel="noopener">Agendar sesión guiada (45 min)</a>
      <a class="btn btn-grad-green" href="https://wa.me/5568437918?text=Hola%20Expiriti%2C%20quiero%20comprar%20mi%20licencia%20de%20CONTPAQi%20XML%20en%20L%C3%ADnea" target="_blank" rel="noopener">Comprar ahora</a>
    </div>
  </section>

  <aside class="toc collapsed" id="toc">
    <button class="toc-toggle" id="tocToggle" aria-label="Abrir mapa">🗺️ Mapa</button>
    <button class="toc-close" aria-label="Cerrar">×</button>
    <strong class="toc-title">Mapa del sitio</strong>
    <a href="#caracteristicas">Por qué CONTPAQi?</a>
    <a href="#videos">Vídeos</a>
    <a href="#integra">Sistemas integrables</a>
    <a href="#calculadora-section">Precio</a>
    <a href="#comparativa">Comparativa</a>
    <a href="#faq">Preguntas frecuentes</a>
    <a href="#sesion-guiada">Demo</a>
  </aside>
</main>

<footer>
  <div class="container footer-grid">
    <div>
      <h3 class="footer-title">Contacto</h3>
      <div class="contact-list">
        <div class="item"><span class="ico">📍</span><span><strong>Ubicación:</strong> Insurgentes Sur 1188, CDMX</span></div>
        <div class="item"><span class="ico">☎️</span><span><strong>Tel:</strong> <a href="tel:+525568437917">55 6843 7917</a> · <a href="tel:+525568437918">55 6843 7918</a></span></div>
        <div class="item"><span class="ico">✉️</span><span><strong>Mail:</strong> <a href="mailto:andree@expiriti.com.mx">andree@expiriti.com.mx</a></span></div>
      </div>
    </div>
    <div>
      <h3 class="footer-title">Formas de pago</h3>
      <div class="payments-grid"><img src="../IMG/pasarela-2.webp" alt="métodos de pago" loading="lazy"></div>
    </div>
    <div>
      <h3 class="footer-title">Marcas</h3>
      <div class="brands-col">
        <div class="brand-item"><img src="../IMG/CONTPAQi.webp" alt="CONTPAQi"></div>
        <div class="brand-item"><img src="../IMG/Microsoft.webp" alt="Microsoft"></div>
      </div>
    </div>
    <div class="ally-col">
      <h3 class="footer-title" style="justify-self:end">Aliados</h3>
      <img src="../IMG/bni.webp" alt="BNI" loading="lazy">
      <img src="../IMG/fucam.webp" alt="FUCAM" loading="lazy">
      <img src="../IMG/expiritilogo.webp" alt="Expiriti" loading="lazy">
    </div>
  </div>
  <div class="container footer-bottom">
    <div style="display:flex;align-items:center;gap:10px">
      <img src="../IMG/expiritilogo.webp" alt="Expiriti" style="width:34px;height:34px;border-radius:8px">
      <div><strong>Expiriti</strong><div class="hint">© <span id="year"></span> · Todos los derechos reservados</div></div>
    </div>
    <div class="hint">Aviso de privacidad · Términos</div>
  </div>
</footer>

<script>
// Año y menú móvil
document.getElementById('year').textContent=new Date().getFullYear();
document.getElementById('burger')?.addEventListener('click',()=>{document.getElementById('mobileMenu')?.classList.toggle('open');});

// TOC (Mapa)
(function(){
  const toc=document.getElementById('toc'), openBtn=document.getElementById('tocToggle'), closeBtn=toc?.querySelector('.toc-close');
  if(!toc||!openBtn||!closeBtn) return;
  openBtn.addEventListener('click',e=>{e.stopPropagation();toc.classList.toggle('collapsed');});
  closeBtn.addEventListener('click',()=>toc.classList.add('collapsed'));
  toc.querySelectorAll('a').forEach(a=>a.addEventListener('click',()=>toc.classList.add('collapsed')));
  document.addEventListener('click',e=>{if(!toc.contains(e.target) && e.target!==openBtn) toc.classList.add('collapsed');});
})();

// Galería portada
(function(){
  const root=document.getElementById('carousel1'); if(!root) return;
  const track=root.querySelector('.carousel-track'), dots=[...root.querySelectorAll('.dot')];
  const prev=root.querySelector('.arrowCircle.prev'), next=root.querySelector('.arrowCircle.next');
  let idx=0;
  function setActive(i){idx=(i+dots.length)%dots.length; dots.forEach((d,di)=>d.classList.toggle('active',di===idx)); track.scrollTo({left: track.clientWidth*idx, behavior:'smooth'});}
  dots.forEach((d,i)=>d.addEventListener('click',()=>setActive(i)));
  prev.addEventListener('click',()=>setActive(idx-1));
  next.addEventListener('click',()=>setActive(idx+1));
  track.addEventListener('scroll',()=>{const i=Math.round(track.scrollLeft/track.clientWidth); dots.forEach((d,di)=>d.classList.toggle('active',di===i)); idx=i;});
  window.addEventListener('resize',()=>setActive(idx)); setActive(0);
})();

// Carrusel Reels
(function(){
  const root=document.getElementById('carouselReels'); if(!root) return;
  const track=root.querySelector('.carousel-track'), dots=[...root.querySelectorAll('.dot')];
  const prev=root.querySelector('.arrowCircle.prev'), next=root.querySelector('.arrowCircle.next');
  let idx=0;
  function setActive(i){idx=(i+dots.length)%dots.length; dots.forEach((d,di)=>d.classList.toggle('active',di===idx)); track.scrollTo({left: track.clientWidth*idx, behavior:'smooth'});}
  dots.forEach((d,i)=>d.addEventListener('click',()=>setActive(i)));
  prev.addEventListener('click',()=>setActive(idx-1));
  next.addEventListener('click',()=>setActive(idx+1));
  track.addEventListener('scroll',()=>{const i=Math.round(track.scrollLeft/track.clientWidth); dots.forEach((d,di)=>d.classList.toggle('active',di===i)); idx=i;});
  window.addEventListener('resize',()=>setActive(idx)); setActive(0);
})();

// Slider Por qué usar
(function(){
  const wrap=document.querySelector('#beneficios .listSlider'); if(!wrap) return;
  const track=wrap.querySelector('.listTrack'), prev=wrap.querySelector('.prev'), next=wrap.querySelector('.next');
  let page=0, total=track.children.length;
  function go(i){page=(i+total)%total; track.scrollTo({left: wrap.clientWidth*page, behavior:'smooth'});}
  prev.addEventListener('click',()=>go(page-1)); next.addEventListener('click',()=>go(page+1));
  window.addEventListener('resize',()=>go(page));
})();

// Carrusel sistemas integrables
(function(){
  document.querySelectorAll('.carouselX').forEach(root=>{
    const track=root.querySelector('.track'),
          prev=root.querySelector('.arrowCircle.prev'),
          next=root.querySelector('.arrowCircle.next'),
          dotsWrap=root.querySelector('.group-dots');
    function groupW(){return track.clientWidth;}
    function groupsCount(){const n=track.querySelectorAll('.sys').length; return Math.max(1, Math.ceil(n/3));}

    const paginate = groupsCount() > 1;
    if (!paginate){
      prev.style.display='none'; next.style.display='none'; dotsWrap.style.display='none';
      return;
    }

    function setDot(i){dots.forEach((d,idx)=>d.classList.toggle('active',idx===i));}
    function goTo(i){track.scrollTo({left:i*groupW(),behavior:'smooth'}); setDot(i);}

    dotsWrap.innerHTML='';
    const dots=Array.from({length:groupsCount()},(_,i)=>{
      const b=document.createElement('button');
      b.className='dot'+(i===0?' active':'');
      b.addEventListener('click',()=>goTo(i));
      dotsWrap.appendChild(b);
      return b;
    });
    let idx=0;
    prev.addEventListener('click',()=>{idx=Math.max(0,idx-1); goTo(idx);});
    next.addEventListener('click',()=>{idx=Math.min(dots.length-1,idx+1); goTo(idx);});
    window.addEventListener('resize',()=>goTo(idx));
  });
})();

// Píldoras (filtros)
(function(){
  const pills=[...document.querySelectorAll('.pill')];
  const cards=[...document.querySelectorAll('.feature-grid .fcard')];
  function apply(filter){
    cards.forEach(c=>{
      const show =
        (filter==='descarga' && c.classList.contains('tag-descarga')) ||
        (filter==='gestion' && c.classList.contains('tag-gestion')) ||
        (filter==='integracion' && c.classList.contains('tag-integracion'));
      c.style.display = show ? '' : 'none';
    });
  }
  pills.forEach(p=>{
    p.addEventListener('click',()=>{
      pills.forEach(x=>x.classList.remove('active'));
      p.classList.add('active');
      apply(p.dataset.filter);
    });
  });
  apply('descarga');
})();

// ====== Calculadora helpers ======
function hasPrices(systemName){return !!(window.preciosContpaqi && window.preciosContpaqi[systemName]);}

// Catálogo visual (coincide con precios-contpaqi.js) — XML no se muestra para combinar
const CATALOG_SISTEMAS = [
  { name: "CONTPAQi Contabilidad",       img: "../IMG/contabilidad.webp" },
  { name: "CONTPAQi Bancos",             img: "../IMG/bancos.webp"  },
  { name: "CONTPAQi Nóminas",            img: "../IMG/nominas.webp" },
  { name: "CONTPAQi Comercial START",    img: "../IMG/comercialstart.webp"  },
  { name: "CONTPAQi Comercial PRO",      img: "../IMG/comercialpro.webp"    },
  { name: "CONTPAQi Comercial PREMIUM",  img: "../IMG/comercialpremium.webp"},
  { name: "CONTPAQi Factura Electrónica",img: "../IMG/factura.webp" }
];

// Precio “desde”
function getPrecioDesde(systemName){
  const db = (window.preciosContpaqi && window.preciosContpaqi[systemName]) || null;
  if(!db) return null;
  if (db.anual?.MultiRFC?.precio_base || db.anual?.MultiRFC?.renovacion)
    return Number(db.anual.MultiRFC.precio_base || db.anual.MultiRFC.renovacion || 0);
  if (db.anual?.MonoRFC?.precio_base || db.anual?.MonoRFC?.renovacion)
    return Number(db.anual.MonoRFC.precio_base || db.anual.MonoRFC.renovacion || 0);
  if (db.tradicional?.actualizacion?.precio_base)
    return Number(db.tradicional.actualizacion.precio_base);
  return null;
}
const moneyMX = new Intl.NumberFormat("es-MX", { style:"currency", currency:"MXN", maximumFractionDigits:0 });

/** ========= Estado de selección ========= */
const selected = { secondary: null, tertiary: null };
function selectedSet(){ return new Set([selected.secondary, selected.tertiary].filter(Boolean)); }

/** ========= Render dinámico de pickers con exclusiones ========= */
function renderSistemasPicker(containerId, exclude = new Set(), activeName = null){
  const wrap = document.getElementById(containerId);
  if(!wrap) return;
  wrap.innerHTML = "";
  const primarySys = document.getElementById('app')?.dataset?.system;
  if (primarySys) exclude.add(primarySys); // Excluir siempre el primario

  CATALOG_SISTEMAS.forEach(item=>{
    if (exclude.has(item.name)) return;
    const precio = getPrecioDesde(item.name);
    const btn = document.createElement("button");
    btn.className = "sys-icon";
    btn.type = "button";
    btn.dataset.sys = item.name;
    btn.title = item.name;
    btn.innerHTML = `
      <img src="${item.img}" alt="${item.name}">
      <strong>${item.name.replace('CONTPAQi ','')}</strong>
      <small class="sys-price">${precio != null ? 'desde '+moneyMX.format(precio) : 'precio no disp.'}</small>
    `;
    if (activeName && activeName === item.name) btn.classList.add('active');
    wrap.appendChild(btn);
  });
}

/** ========= Resumen combinado ========= */
function renderCombinedTable(rows){
  const wrap=document.getElementById('combined-wrap');
  const tbody=document.getElementById('combined-table-body');
  if(!wrap||!tbody) return;
  tbody.innerHTML='';
  rows.forEach(([concepto, importe])=>{
    const tr=document.createElement('tr');
    const td1=document.createElement('td'); td1.textContent=concepto;
    const td2=document.createElement('td'); td2.textContent=importe; td2.style.textAlign='right';
    tr.appendChild(td1); tr.appendChild(td2); tbody.appendChild(tr);
  });
  wrap.hidden=false;
}

/** ========= Inicialización ========= */
document.addEventListener("DOMContentLoaded", ()=>{
  const row=document.getElementById('calc-row'),
        slot2=document.getElementById('calc-slot-2'),
        slot3=document.getElementById('calc-tertiary'),
        addMore=document.getElementById('add-more-panel');
  const pick2=document.getElementById('icons-sec-sys'),
        pick3=document.getElementById('icons-third-sys');
  const primarySystem = document.getElementById('app')?.dataset?.system;

  // Render inicial
  const initialExclude = new Set(primarySystem ? [primarySystem] : []);
  renderSistemasPicker("icons-sec-sys", initialExclude);
  renderSistemasPicker("icons-third-sys", initialExclude);

  function refreshPickers(){
    const ex = selectedSet();
    if (primarySystem) ex.add(primarySystem);
    renderSistemasPicker("icons-sec-sys", ex, selected.secondary);
    renderSistemasPicker("icons-third-sys", ex, selected.tertiary);
  }

  function showAddMoreIfReady(){
    if(addMore) addMore.style.display = selected.secondary ? '' : 'none';
  }

  // ===== Secundaria =====
  pick2?.addEventListener('click', e=>{
    const btn=e.target.closest('.sys-icon'); if(!btn) return;
    const sys=btn.dataset.sys; if(!hasPrices(sys)) return;
    selected.secondary = sys;
    selected.tertiary  = selected.tertiary === sys ? null : selected.tertiary;
    slot2.className='calc-container'; slot2.id='calc-secondary';
    if(window.CalculadoraContpaqi){
      CalculadoraContpaqi.setSecondarySystem(sys,{
        secondarySelector:'#calc-secondary',
        combinedSelector:'#combined-wrap',
        onCombined:renderCombinedTable
      });
    }
    refreshPickers();
    showAddMoreIfReady();
  });

  // ===== Terciaria =====
  pick3?.addEventListener('click', e=>{
    const btn=e.target.closest('.sys-icon'); if(!btn) return;
    const sys=btn.dataset.sys; if(!hasPrices(sys)) return;
    if (sys === selected.secondary) return;
    selected.tertiary = sys;
    slot3.style.display='block';
    if(window.CalculadoraContpaqi){
      CalculadoraContpaqi.setTertiarySystem(sys,{
        tertiarySelector:'#calc-tertiary',
        combinedSelector:'#combined-wrap',
        onCombined:renderCombinedTable
      });
    }
    if(addMore) addMore.style.display='none';
    row.classList.add('has-three');
    refreshPickers();
  });

  // Núcleo: primaria
  if(!window.CalculadoraContpaqi){
    console.error('❌ calculadora.js no cargó. Verifica ruta.');
  }else{
    const app=document.getElementById('app');
    const sys=app?.dataset?.system;
    if(sys){
      window.CalculadoraContpaqi.init({
        systemName: sys,
        primarySelector:'#calc-primary',
        combinedSelector:'#combined-wrap'
      });
    }
  }
});

// FAQ modo acordeón (opcional)
(function(){
  const wrap=document.getElementById('faqWrap'); if(!wrap) return;
  const items=[...wrap.querySelectorAll('.faq-item')];
  items.forEach(d=>{
    d.addEventListener('toggle', ()=>{
      if(d.open){ items.forEach(o=>{ if(o!==d) o.removeAttribute('open'); }); }
    });
  });
})();
</script>

<script defer src="../precios-contpaqi.js?v=3"></script>
<script defer src="../calculadora.js?v=13"></script>
</body>
</html>
